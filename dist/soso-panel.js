var $={},Je={layout:"row",visible:!0},x=(e,t,n={})=>{$[e]={...Je,...n,component:t}},_e=e=>e in $?!0:(console.warn(`control of type "${e}" is requested but not registered`),!1),de=e=>{if(!_e(e.type))return;let{component:t,...n}=$[e.type];return n},fe=e=>{if(!_e(e.type))return;let{component:t,...n}=$[e.type];return t};var J,y,be,Ke,V,he,ye,xe,we,ne,te,oe,Ze,R={},ke=[],Qe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,K=Array.isArray;function H(e,t){for(var n in t)e[n]=t[n];return e}function se(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function et(e,t,n){var o,s,r,i={};for(r in t)r=="key"?o=t[r]:r=="ref"?s=t[r]:i[r]=t[r];if(arguments.length>2&&(i.children=arguments.length>3?J.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(r in e.defaultProps)i[r]===void 0&&(i[r]=e.defaultProps[r]);return q(e,i,o,s,null)}function q(e,t,n,o,s){var r={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++be,__i:-1,__u:0};return s==null&&y.vnode!=null&&y.vnode(r),r}function A(e){return e.children}function O(e,t){this.props=e,this.context=t}function I(e,t){if(t==null)return e.__?I(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?I(e):null}function Ce(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Ce(e)}}function me(e){(!e.__d&&(e.__d=!0)&&V.push(e)&&!G.__r++||he!=y.debounceRendering)&&((he=y.debounceRendering)||ye)(G)}function G(){for(var e,t,n,o,s,r,i,l=1;V.length;)V.length>l&&V.sort(xe),e=V.shift(),l=V.length,e.__d&&(n=void 0,s=(o=(t=e).__v).__e,r=[],i=[],t.__P&&((n=H({},o)).__v=o.__v+1,y.vnode&&y.vnode(n),re(t.__P,n,o,t.__n,t.__P.namespaceURI,32&o.__u?[s]:null,r,s??I(o),!!(32&o.__u),i),n.__v=o.__v,n.__.__k[n.__i]=n,Ee(r,n,i),n.__e!=s&&Ce(n)));G.__r=0}function Se(e,t,n,o,s,r,i,l,p,u,c){var a,d,f,b,h,g,m=o&&o.__k||ke,v=t.length;for(p=tt(n,t,m,p,v),a=0;a<v;a++)(f=n.__k[a])!=null&&(d=f.__i==-1?R:m[f.__i]||R,f.__i=a,g=re(e,f,d,s,r,i,l,p,u,c),b=f.__e,f.ref&&d.ref!=f.ref&&(d.ref&&ae(d.ref,null,f),c.push(f.ref,f.__c||b,f)),h==null&&b!=null&&(h=b),4&f.__u||d.__k===f.__k?p=Ne(f,p,e):typeof f.type=="function"&&g!==void 0?p=g:b&&(p=b.nextSibling),f.__u&=-7);return n.__e=h,p}function tt(e,t,n,o,s){var r,i,l,p,u,c=n.length,a=c,d=0;for(e.__k=new Array(s),r=0;r<s;r++)(i=t[r])!=null&&typeof i!="boolean"&&typeof i!="function"?(p=r+d,(i=e.__k[r]=typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?q(null,i,null,null,null):K(i)?q(A,{children:i},null,null,null):i.constructor==null&&i.__b>0?q(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=e,i.__b=e.__b+1,l=null,(u=i.__i=ot(i,n,p,a))!=-1&&(a--,(l=n[u])&&(l.__u|=2)),l==null||l.__v==null?(u==-1&&(s>c?d--:s<c&&d++),typeof i.type!="function"&&(i.__u|=4)):u!=p&&(u==p-1?d--:u==p+1?d++:(u>p?d--:d++,i.__u|=4))):e.__k[r]=null;if(a)for(r=0;r<c;r++)(l=n[r])!=null&&(2&l.__u)==0&&(l.__e==o&&(o=I(l)),Ae(l,l));return o}function Ne(e,t,n){var o,s;if(typeof e.type=="function"){for(o=e.__k,s=0;o&&s<o.length;s++)o[s]&&(o[s].__=e,t=Ne(o[s],t,n));return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=I(e)),n.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function ot(e,t,n,o){var s,r,i=e.key,l=e.type,p=t[n];if(p===null&&e.key==null||p&&i==p.key&&l==p.type&&(2&p.__u)==0)return n;if(o>(p!=null&&(2&p.__u)==0?1:0))for(s=n-1,r=n+1;s>=0||r<t.length;){if(s>=0){if((p=t[s])&&(2&p.__u)==0&&i==p.key&&l==p.type)return s;s--}if(r<t.length){if((p=t[r])&&(2&p.__u)==0&&i==p.key&&l==p.type)return r;r++}}return-1}function ve(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Qe.test(t)?n:n+"px"}function j(e,t,n,o,s){var r,i;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||ve(e.style,t,"");if(n)for(t in n)o&&n[t]==o[t]||ve(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")r=t!=(t=t.replace(we,"$1")),i=t.toLowerCase(),t=i in e||t=="onFocusOut"||t=="onFocusIn"?i.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?o?n.u=o.u:(n.u=ne,e.addEventListener(t,r?oe:te,r)):e.removeEventListener(t,r?oe:te,r);else{if(s=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function ge(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=ne++;else if(t.t<n.u)return;return n(y.event?y.event(t):t)}}}function re(e,t,n,o,s,r,i,l,p,u){var c,a,d,f,b,h,g,m,v,C,S,E,P,X,Y,D,L,T=t.type;if(t.constructor!=null)return null;128&n.__u&&(p=!!(32&n.__u),r=[l=t.__e=n.__e]),(c=y.__b)&&c(t);e:if(typeof T=="function")try{if(m=t.props,v="prototype"in T&&T.prototype.render,C=(c=T.contextType)&&o[c.__c],S=c?C?C.props.value:c.__:o,n.__c?g=(a=t.__c=n.__c).__=a.__E:(v?t.__c=a=new T(m,S):(t.__c=a=new O(m,S),a.constructor=T,a.render=st),C&&C.sub(a),a.props=m,a.state||(a.state={}),a.context=S,a.__n=o,d=a.__d=!0,a.__h=[],a._sb=[]),v&&a.__s==null&&(a.__s=a.state),v&&T.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=H({},a.__s)),H(a.__s,T.getDerivedStateFromProps(m,a.__s))),f=a.props,b=a.state,a.__v=t,d)v&&T.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),v&&a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(v&&T.getDerivedStateFromProps==null&&m!==f&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(m,S),!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(m,a.__s,S)===!1||t.__v==n.__v){for(t.__v!=n.__v&&(a.props=m,a.state=a.__s,a.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(M){M&&(M.__=t)}),E=0;E<a._sb.length;E++)a.__h.push(a._sb[E]);a._sb=[],a.__h.length&&i.push(a);break e}a.componentWillUpdate!=null&&a.componentWillUpdate(m,a.__s,S),v&&a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(f,b,h)})}if(a.context=S,a.props=m,a.__P=e,a.__e=!1,P=y.__r,X=0,v){for(a.state=a.__s,a.__d=!1,P&&P(t),c=a.render(a.props,a.state,a.context),Y=0;Y<a._sb.length;Y++)a.__h.push(a._sb[Y]);a._sb=[]}else do a.__d=!1,P&&P(t),c=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++X<25);a.state=a.__s,a.getChildContext!=null&&(o=H(H({},o),a.getChildContext())),v&&!d&&a.getSnapshotBeforeUpdate!=null&&(h=a.getSnapshotBeforeUpdate(f,b)),D=c,c!=null&&c.type===A&&c.key==null&&(D=Te(c.props.children)),l=Se(e,K(D)?D:[D],t,n,o,s,r,i,l,p,u),a.base=t.__e,t.__u&=-161,a.__h.length&&i.push(a),g&&(a.__E=a.__=null)}catch(M){if(t.__v=null,p||r!=null)if(M.then){for(t.__u|=p?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;r[r.indexOf(l)]=null,t.__e=l}else for(L=r.length;L--;)se(r[L]);else t.__e=n.__e,t.__k=n.__k;y.__e(M,t,n)}else r==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):l=t.__e=nt(n.__e,t,n,o,s,r,i,p,u);return(c=y.diffed)&&c(t),128&t.__u?void 0:l}function Ee(e,t,n){for(var o=0;o<n.length;o++)ae(n[o],n[++o],n[++o]);y.__c&&y.__c(t,e),e.some(function(s){try{e=s.__h,s.__h=[],e.some(function(r){r.call(s)})}catch(r){y.__e(r,s.__v)}})}function Te(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:K(e)?e.map(Te):H({},e)}function nt(e,t,n,o,s,r,i,l,p){var u,c,a,d,f,b,h,g=n.props,m=t.props,v=t.type;if(v=="svg"?s="http://www.w3.org/2000/svg":v=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),r!=null){for(u=0;u<r.length;u++)if((f=r[u])&&"setAttribute"in f==!!v&&(v?f.localName==v:f.nodeType==3)){e=f,r[u]=null;break}}if(e==null){if(v==null)return document.createTextNode(m);e=document.createElementNS(s,v,m.is&&m),l&&(y.__m&&y.__m(t,r),l=!1),r=null}if(v==null)g===m||l&&e.data==m||(e.data=m);else{if(r=r&&J.call(e.childNodes),g=n.props||R,!l&&r!=null)for(g={},u=0;u<e.attributes.length;u++)g[(f=e.attributes[u]).name]=f.value;for(u in g)if(f=g[u],u!="children"){if(u=="dangerouslySetInnerHTML")a=f;else if(!(u in m)){if(u=="value"&&"defaultValue"in m||u=="checked"&&"defaultChecked"in m)continue;j(e,u,null,f,s)}}for(u in m)f=m[u],u=="children"?d=f:u=="dangerouslySetInnerHTML"?c=f:u=="value"?b=f:u=="checked"?h=f:l&&typeof f!="function"||g[u]===f||j(e,u,f,g[u],s);if(c)l||a&&(c.__html==a.__html||c.__html==e.innerHTML)||(e.innerHTML=c.__html),t.__k=[];else if(a&&(e.innerHTML=""),Se(t.type=="template"?e.content:e,K(d)?d:[d],t,n,o,v=="foreignObject"?"http://www.w3.org/1999/xhtml":s,r,i,r?r[0]:n.__k&&I(n,0),l,p),r!=null)for(u=r.length;u--;)se(r[u]);l||(u="value",v=="progress"&&b==null?e.removeAttribute("value"):b!=null&&(b!==e[u]||v=="progress"&&!b||v=="option"&&b!=g[u])&&j(e,u,b,g[u],s),u="checked",h!=null&&h!=e[u]&&j(e,u,h,g[u],s))}return e}function ae(e,t,n){try{if(typeof e=="function"){var o=typeof e.__u=="function";o&&e.__u(),o&&t==null||(e.__u=e(t))}else e.current=t}catch(s){y.__e(s,n)}}function Ae(e,t,n){var o,s;if(y.unmount&&y.unmount(e),(o=e.ref)&&(o.current&&o.current!=e.__e||ae(o,null,t)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(r){y.__e(r,t)}o.base=o.__P=null}if(o=e.__k)for(s=0;s<o.length;s++)o[s]&&Ae(o[s],t,n||typeof e.type!="function");n||se(e.__e),e.__c=e.__=e.__e=void 0}function st(e,t,n){return this.constructor(e,n)}function ie(e,t,n){var o,s,r,i;t==document&&(t=document.documentElement),y.__&&y.__(e,t),s=(o=typeof n=="function")?null:n&&n.__k||t.__k,r=[],i=[],re(t,e=(!o&&n||t).__k=et(A,null,[e]),s||R,R,t.namespaceURI,!o&&n?[n]:s?null:t.firstChild?J.call(t.childNodes):null,r,!o&&n?n:s?s.__e:t.firstChild,o,i),Ee(r,e,i)}J=ke.slice,y={__e:function(e,t,n,o){for(var s,r,i;t=t.__;)if((s=t.__c)&&!s.__)try{if((r=s.constructor)&&r.getDerivedStateFromError!=null&&(s.setState(r.getDerivedStateFromError(e)),i=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(e,o||{}),i=s.__d),i)return s.__E=s}catch(l){e=l}throw e}},be=0,Ke=function(e){return e!=null&&e.constructor==null},O.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=H({},this.state),typeof e=="function"&&(e=e(H({},n),this.props)),e&&H(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),me(this))},O.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),me(this))},O.prototype.render=A,V=[],ye=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,xe=function(e,t){return e.__v.__b-t.__v.__b},G.__r=0,we=/(PointerCapture)$|Capture$/i,ne=0,te=ge(!1),oe=ge(!0),Ze=0;var rt=0,Dt=Array.isArray;function _(e,t,n,o,s,r){t||(t={});var i,l,p=t;if("ref"in p)for(l in p={},t)l=="ref"?i=t[l]:p[l]=t[l];var u={type:e,props:p,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--rt,__i:-1,__u:0,__source:s,__self:r};if(typeof e=="function"&&(i=e.defaultProps))for(l in i)p[l]===void 0&&(p[l]=i[l]);return y.vnode&&y.vnode(u),u}var at=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id];return _("button",{type:"button",onClick:()=>n({[o.id]:{value:!0}},{event:!0}),children:o.text??o.id})};x("button",at,{label:null});var B,w,le,Pe,Q=0,Ve=[],k=y,ze=k.__b,De=k.__r,He=k.diffed,Xe=k.__c,Ye=k.unmount,Le=k.__;function ce(e,t){k.__h&&k.__h(w,e,Q||t),Q=0;var n=w.__H||(w.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function N(e){return Q=1,it(Ue,e)}function it(e,t,n){var o=ce(B++,2);if(o.t=e,!o.__c&&(o.__=[n?n(t):Ue(void 0,t),function(l){var p=o.__N?o.__N[0]:o.__[0],u=o.t(p,l);p!==u&&(o.__N=[u,o.__[1]],o.__c.setState({}))}],o.__c=w,!w.__f)){var s=function(l,p,u){if(!o.__c.__H)return!0;var c=o.__c.__H.__.filter(function(d){return!!d.__c});if(c.every(function(d){return!d.__N}))return!r||r.call(this,l,p,u);var a=o.__c.props!==l;return c.forEach(function(d){if(d.__N){var f=d.__[0];d.__=d.__N,d.__N=void 0,f!==d.__[0]&&(a=!0)}}),r&&r.call(this,l,p,u)||a};w.__f=!0;var r=w.shouldComponentUpdate,i=w.componentWillUpdate;w.componentWillUpdate=function(l,p,u){if(this.__e){var c=r;r=void 0,s(l,p,u),r=c}i&&i.call(this,l,p,u)},w.shouldComponentUpdate=s}return o.__N||o.__}function z(e,t){var n=ce(B++,3);!k.__s&&Ie(n.__H,t)&&(n.__=e,n.u=t,w.__H.__h.push(n))}function Fe(e){return Q=5,lt(function(){return{current:e}},[])}function lt(e,t){var n=ce(B++,7);return Ie(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function ut(){for(var e;e=Ve.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Z),e.__H.__h.forEach(ue),e.__H.__h=[]}catch(t){e.__H.__h=[],k.__e(t,e.__v)}}k.__b=function(e){w=null,ze&&ze(e)},k.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Le&&Le(e,t)},k.__r=function(e){De&&De(e),B=0;var t=(w=e.__c).__H;t&&(le===w?(t.__h=[],w.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(Z),t.__h.forEach(ue),t.__h=[],B=0)),le=w},k.diffed=function(e){He&&He(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ve.push(t)!==1&&Pe===k.requestAnimationFrame||((Pe=k.requestAnimationFrame)||ct)(ut)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),le=w=null},k.__c=function(e,t){t.some(function(n){try{n.__h.forEach(Z),n.__h=n.__h.filter(function(o){return!o.__||ue(o)})}catch(o){t.some(function(s){s.__h&&(s.__h=[])}),t=[],k.__e(o,n.__v)}}),Xe&&Xe(e,t)},k.unmount=function(e){Ye&&Ye(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{Z(o)}catch(s){t=s}}),n.__H=void 0,t&&k.__e(t,n.__v))};var Me=typeof requestAnimationFrame=="function";function ct(e){var t,n=function(){clearTimeout(o),Me&&cancelAnimationFrame(t),setTimeout(e)},o=setTimeout(n,35);Me&&(t=requestAnimationFrame(n))}function Z(e){var t=w,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),w=t}function ue(e){var t=w;e.__c=e.__(),w=t}function Ie(e,t){return!e||e.length!==t.length||t.some(function(n,o){return n!==e[o]})}function Ue(e,t){return typeof t=="function"?t(e):t}var Re=e=>e.trim()==="",Be=e=>isFinite(e),pt=(e,t)=>String(e)!==t,_t=(e,t,n)=>e>=t&&e<=n,dt=(e,t,n)=>Math.min(Math.max(e,t),n),F=({value:e,min:t=-1/0,max:n=1/0,commit:o})=>{let[s,r]=N(String(e)),[i,l]=N(e);z(()=>{r(String(e)),l(e)},[e]);function p(c){let a=String(c);if(r(a),Re(a))return;let d=Number(a);!Be(d)||!_t(d,t,n)||pt(d,a)||(l(d),o(d))}function u(){if(Re(s)||!Be(Number(s))){r(String(i));return}let c=Number(s),a=dt(c,t,n);r(String(a)),l(a),o(a)}return{value:e,text:s,setValue:p,handleBlur:u}},U=e=>Array.isArray(e)&&e.every(t=>t!=null&&typeof t=="object"&&!Array.isArray(t)&&"label"in t&&"value"in t)?e:Array.isArray(e)?e.map(t=>({label:String(t),value:t})):e&&typeof e=="object"?Object.entries(e).map(([t,n])=>({label:t,value:n})):[];var ft=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id],s=U(o.options).map(({label:r,value:i},l)=>{let p=o.value===i?"soso-selected":"";return _("button",{onClick:()=>n({[o.id]:{value:i}}),className:`${p}`,type:"button",children:r},r)});return _("div",{className:"soso-buttons",children:s})};x("buttons",ft,{value:e=>U(e.options)[0]?.value});var ht=e=>"#ffffff",mt=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id],[s,r]=N(o.value),[i,l]=N(o.value);z(()=>{r(o.value)},[o.value]);let p=a=>a.startsWith("#")&&a.length===7&&CSS.supports("color",a),u=a=>{let d=a.currentTarget.value,f=p(d)?d:i;n({[o.id]:{value:f}}),r(f)},c=a=>{let d=a.currentTarget.value;p(d)&&(n({[o.id]:{value:d}}),l(d))};return _(A,{children:[_("input",{type:"color",value:s,onInput:c,className:"soso-color-picker"}),_("input",{type:"text",className:"soso-fixed",size:"7",value:s,onInput:c,onChange:u})]})};x("color",mt,{value:ht});var vt=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id];switch(o.format){case"monospace":return _("span",{className:"soso-display soso-monospace",children:o.value});case"block":return _("pre",{className:"soso-display soso-monospace",children:o.value});case"html":return _("span",{className:"soso-display",dangerouslySetInnerHTML:{__html:o.value??""}});default:return _("span",{className:"soso-display",children:o.value})}};x("display",vt,{value:"",format:"text"});var gt=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id],s=Fe(null),[r,i]=N(Array(o.samples).fill(0)),[l,p]=N({min:null,max:null});return z(()=>{i(u=>[...u,o.value].slice(-o.samples)),p(u=>({min:u.min===null?o.value:Math.min(u.min,o.value),max:u.max===null?o.value:Math.max(u.max,o.value)}))},[o]),z(()=>{let u=s.current;if(!u)return;let c=u.getContext("2d"),a=u.getBoundingClientRect(),d=window.devicePixelRatio||1,f=a.width,b=o.height;u.width=f*d,u.height=b*d,c.scale(d,d),u.style.width=f+"px",u.style.height=b+"px",c.clearRect(0,0,f,b);let h=u.closest(".soso-panel"),m=getComputedStyle(h).getPropertyValue("--panel-fg").trim()||"#aaa",v=o.min??l.min??0,C=o.max??l.max??1,S=C-v||1,E=1/(o.samples-1)*f;c.fillStyle=m,c.globalAlpha=.5,c.beginPath(),c.moveTo(0,b),r.forEach((P,X)=>{let Y=(P-v)/S*b,D=X*E,L=b-Y;c.lineTo(D,L)}),c.lineTo(f,b),c.fill(),c.globalAlpha=1,c.font="10px ui-monospace, monospace",c.textBaseline="top",c.textAlign="left",c.fillText(C,3,0),c.textBaseline="bottom",c.fillText(v,3,b)},[r,l,o]),_("canvas",{className:"soso-graph",ref:s,height:o.height})};x("graph",gt,{height:60,samples:60});var ee=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id];if(!o.visible)return null;let s=fe(o);if(!s)return null;let r=_(s,{nodes:e,treeNode:t,update:n});if(o.layout==="block")return r;let i=!(o.label===""||o.label===null);return _("div",{className:"soso-row",role:"group","aria-label":o.label??o.id,children:[i&&_("span",{className:"soso-label",children:o.label??o.id}),_("div",{className:"soso-control",children:r})]})};var bt=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id],s=t.nodes.map((p,u)=>_(ee,{nodes:e,treeNode:p,update:n},p.id)),r=o.expanded?"soso-expanded":"soso-collapsed",i=o.showLabel?"soso-show-label":"soso-hide-label",l=!(o.label===""||o.label===null);return _("div",{className:`soso-group ${r} ${i}`,children:[l&&_("span",{className:"soso-label",onClick:()=>{o.expandable&&n({[o.id]:{expanded:!o.expanded}})},children:[o.expandable&&_("span",{className:"soso-icon",children:"\u2303"}),o.label??o.id]}),_("div",{className:"soso-container",children:s})]})};x("group",bt,{layout:"block",expandable:!0,expanded:!0});var yt=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id],{text:s,setValue:r,handleBlur:i}=F({value:o.value,min:o.min,max:o.max,commit:l=>n({[o.id]:{value:l}})});return _("input",{className:"soso-number-input",type:"text",value:s,onInput:l=>r(l.currentTarget.value),onChange:i})};x("number",yt,{value:()=>0});var We=(e,t)=>{let n=1/t;return Math.round(e*n)/n},xt=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id],{x:s,y:r}=o.value,[i,l]=N(!1),[p,u]=N(null),[c,a]=N({height:176,width:176,space:6,radius:2});z(()=>{let h=document.querySelector(".soso-panel");if(!h)return;let g=getComputedStyle(h),m=g.getPropertyValue("--panel-width"),v=g.getPropertyValue("--label-width"),C=g.getPropertyValue("--panel-radius"),S=g.getPropertyValue("--panel-space"),E=parseFloat(m)-parseFloat(v)-2*parseFloat(S),P=parseFloat(C),X=parseFloat(S);a({width:E,height:E,radius:P,space:X})},[]);let d=F({value:o.value.x,min:o.minX,max:o.maxX,commit:h=>n({[o.id]:{value:{...o.value,x:h}}})}),f=F({value:o.value.y,min:o.minY,max:o.maxY,commit:h=>n({[o.id]:{value:{...o.value,y:h}}})});z(()=>{if(!i||!p)return;let h=document.body.style.cursor;document.body.style.cursor="grabbing";let g=C=>{let S=C.clientX??C.touches?.[0]?.clientX,E=C.clientY??C.touches?.[0]?.clientY;if(S===void 0||E===void 0)return;let P=S-p.pointerX,X=E-p.pointerY,Y=p.valueX+P*o.scale,D=p.valueY+X*o.scale,L=Math.max(o.minX,Math.min(o.maxX,Y)),T=Math.max(o.minY,Math.min(o.maxY,D)),M=We(L,o.step),Ge=We(T,o.step);n({[o.id]:{value:{x:M,y:Ge}}})},m=()=>{l(!1),u(null)},v=C=>(C.preventDefault(),!1);return document.addEventListener("mousemove",g),document.addEventListener("mouseup",m),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",m),()=>{document.body.style.cursor=h,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",m),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",m)}},[i,p,o]);let b=(h,g=null)=>{let m=h.clientX??h.touches?.[0]?.clientX,v=h.clientY??h.touches?.[0]?.clientY;l(!0),u({pointerX:m,pointerY:v,valueX:g?.x??o.value.x,valueY:g?.y??o.value.y})};return _(A,{children:[_("button",{onMouseDown:h=>{h.preventDefault(),b(h)},onTouchStart:h=>{h.preventDefault(),b(h)},className:`soso-translate ${i?"soso-selected":""}`,type:"button",style:{touchAction:"none",userSelect:"none"},children:"\u2316"}),_("input",{className:"soso-number-input soso-fixed",type:"text",size:"7",value:d.text,onInput:h=>d.setValue(h.currentTarget.value),onChange:d.handleBlur}),_("input",{className:"soso-number-input soso-fixed",type:"text",size:"7",value:f.text,onInput:h=>f.setValue(h.currentTarget.value),onChange:f.handleBlur}),i&&_("div",{className:"soso-pad2",children:_("svg",{width:c.width,height:c.height,style:{position:"absolute",top:0,left:0,borderRadius:c.radius},children:[_("rect",{width:c.width,height:c.height,fill:"transparent",className:"soso-border",rx:c.radius}),_("line",{x1:c.width/2,y1:0,x2:c.width/2,y2:c.height,className:"soso-grid"}),_("line",{x1:0,y1:c.height/2,x2:c.width,y2:c.height/2,className:"soso-grid"}),_("text",{x:c.space,y:c.space,className:"soso-label","dominant-baseline":"hanging","font-size":"10",children:[o.minX,",",o.minY]}),_("text",{x:c.width-c.space,y:c.space,"dominant-baseline":"hanging",className:"soso-label","font-size":"10","text-anchor":"end",children:[o.maxX,",",o.minY]}),_("text",{x:c.space,y:c.height-c.space,className:"soso-label","font-size":"10",children:[o.minX,",",o.maxY]}),_("text",{x:c.width-c.space,y:c.height-c.space,className:"soso-label","font-size":"10","text-anchor":"end",children:[o.maxX,",",o.maxY]}),_("circle",{cx:(s-o.minX)/(o.maxX-o.minX)*c.width,cy:(r-o.minY)/(o.maxY-o.minY)*c.height,r:6,className:"soso-indicator"})]})})]})};x("pad2",xt,{value:e=>({x:e.minX+(e.maxX-e.minX)*.5,y:e.minY+(e.maxY-e.minY)*.5}),scale:.01,step:.01,minX:-1,maxX:1,minY:-1,maxY:1});var wt=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id],{text:s,setValue:r,handleBlur:i}=F({value:o.value,min:o.min,max:o.max,commit:l=>n({[o.id]:{value:l}})});return _(A,{children:[_("input",{type:"range",value:s,min:o.min,max:o.max,step:o.step??1,onInput:l=>r(l.currentTarget.value)}),_("input",{type:"text",size:"7",className:"soso-number-input soso-fixed",value:s,onInput:l=>r(l.currentTarget.value),onChange:i})]})};x("range",wt,{value:e=>e.min??0});var kt=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id],s=U(o.options),r=p=>{let u=Number(p.currentTarget.value),c=s[u].value;n({[o.id]:{value:c}})},i=s.map(({label:p},u)=>_("option",{value:u,children:p},p)),l=s.findIndex(({value:p})=>p===o.value);return _("select",{value:l<0?"":l,onChange:r,children:i})};x("select",kt,{value:e=>U(e.options)[0]?.value});var Ct=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id],s=r=>{n({[o.id]:{value:r.currentTarget.value}})};return o.multiline?_("textarea",{value:o.value,onInput:s,rows:o.rows}):_("input",{type:"text",value:o.value,onInput:s})};x("text",Ct,{value:"",multiline:!1,rows:4});var St=({nodes:e,treeNode:t,update:n})=>{let o=e[t.id];return _("input",{type:"checkbox",checked:o.value,onInput:s=>n({[o.id]:{value:s.currentTarget.checked}})})};x("toggle",St,{value:e=>!1});var $e='.soso-panel-container{position:fixed;top:0;right:0}.soso-panel{--panel-bg: hsl(230 7% 10%);--panel-fg: hsl(230 10% 75%);--panel-border: hsl(230 9% 18%);--panel-hover: hsl(230 9% 26%);--panel-pressed: hsl(230 7% 16%);--panel-low-emphasis: hsl(230 4% 55%);--panel-focus: var(--panel-fg);--panel-selection-fg: var(--panel-bg);--panel-selection-bg: var(--panel-fg);--value-number: hsl(220 80% 65%);--value-string: hsl(139 45% 56%);--panel-space: 4px;--panel-radius: 2px;--panel-width: 256px;--label-width: 80px;--row-height: 20px;--font-ui: system-ui, -apple-system, sans-serif;--font-value: ui-monospace, monospace;--font-size-normal: 11px;--line-height-normal: 1.4;--color-link: var(--value-number);--panel-tween-func: cubic-bezier(.25, .8, .5, 1);--panel-tween-duration: .2s;--checkbox-check-width: 3px;--checkbox-check-height: 9px;width:var(--panel-width);color:var(--panel-fg);font-family:var(--font-ui);font-size:var(--font-size-normal);line-height:var(--line-height-normal);box-sizing:border-box;font-variant-numeric:tabular-nums}.soso-panel .soso-row{display:flex;flex-direction:row;gap:var(--panel-space);padding:var(--panel-space) var(--panel-space)}.soso-panel .soso-row+.soso-row{padding-top:calc(var(--panel-space) * .5)}.soso-panel .soso-row:has(+.soso-row){padding-bottom:calc(var(--panel-space) * .5)}.soso-panel .soso-container .soso-container{border-bottom:1px solid var(--panel-border)}.soso-panel .soso-row .soso-label{display:flex;align-self:flex-start;align-items:center;line-height:1.2;min-height:20px;min-width:0;user-select:none;color:var(--panel-low-emphasis);flex:0 0 var(--label-width)}.soso-panel .soso-group{display:flex;flex-direction:column;background:var(--panel-bg);border-radius:var(--panel-radius)}.soso-panel-container>.soso-panel>.soso-group>.soso-label{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.soso-panel .soso-group>.soso-label{display:flex;align-items:center;user-select:none;background:var(--panel-border);border-radius:var(--panel-radius);height:var(--row-height);padding-left:var(--panel-space);gap:var(--panel-space)}.soso-panel .soso-group>.soso-label:has(>.soso-icon){cursor:pointer}.soso-panel .soso-group>.soso-label>.soso-icon{font-weight:700;font-size:10px;cursor:pointer}@media (prefers-reduced-motion: no-preference){.soso-panel .soso-group>.soso-label>.soso-icon{transition:transform var(--panel-tween-duration) var(--panel-tween-func)}}.soso-panel .soso-group.soso-expanded>.soso-label>.soso-icon{transform:rotate(180deg)}.soso-panel .soso-group>.soso-container{flex-direction:column;overflow:hidden;display:none}.soso-panel .soso-group.soso-expanded>.soso-container{display:flex}@supports (interpolate-size: allow-keywords){.soso-panel .soso-group>.soso-container{display:flex;interpolate-size:allow-keywords;height:0;opacity:0}@media (prefers-reduced-motion: no-preference){.soso-panel .soso-group>.soso-container{transition:height var(--panel-tween-duration) var(--panel-tween-func),padding var(--panel-tween-duration) var(--panel-tween-func),opacity var(--panel-tween-duration) var(--panel-tween-func)}}.soso-panel .soso-group.soso-expanded>.soso-container{height:auto;opacity:1}}.soso-panel-container>.soso-panel{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.soso-panel .soso-row .soso-control{flex:1 1 auto;display:flex;justify-content:flex-start;align-items:center;min-height:var(--row-height);gap:var(--panel-space)}.soso-panel button,.soso-panel input,.soso-panel select,.soso-panel textarea{font-size:inherit;font-family:inherit;width:100%;box-sizing:border-box;border:1px solid transparent;padding:0 var(--panel-space);border-radius:var(--panel-radius);background:var(--panel-border);color:var(--panel-fg)}.soso-panel button,.soso-panel select,.soso-panel input[type=text],.soso-panel input[type=range]{min-height:var(--row-height)}.soso-panel input[type=color]{height:var(--row-height)}.soso-panel button,.soso-panel select,.soso-panel input[type=checkbox],.soso-panel input[type=range],.soso-panel input[type=color]{cursor:pointer}.soso-panel input[type=text],.soso-panel textarea{cursor:text}.soso-panel button:focus-visible,.soso-panel select:focus-visible,.soso-panel input:focus-visible,.soso-panel textarea:focus-visible{outline:2px solid var(--panel-focus);outline-offset:0px}.soso-panel button:focus:not(:focus-visible),.soso-panel select:focus:not(:focus-visible),.soso-panel input:focus:not(:focus-visible),.soso-panel textarea:focus:not(:focus-visible){outline:none}.soso-panel button:hover:not(:active):not(.soso-selected),.soso-panel input:hover,.soso-panel select:hover,.soso-panel textarea:hover{background:var(--panel-hover)}.soso-panel button:active,.soso-panel button.soso-selected{background:var(--panel-fg);color:var(--panel-bg);border-radius:var(--panel-radius)}.soso-panel input::selection,.soso-panel textarea::selection{background:var(--panel-selection-bg);color:var(--panel-selection-fg)}.soso-panel textarea{resize:vertical;min-height:calc(var(--row-height) * 2 + var(--panel-space));line-height:var(--line-height-normal);color:var(--value-string);font-family:var(--font-value)}.soso-panel .soso-buttons{display:flex;flex-direction:row;flex:1;gap:var(--panel-space)}.soso-panel .soso-pad2{position:absolute;align-self:flex-start;margin-top:calc(var(--row-height) + var(--panel-space));width:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));height:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));background:var(--panel-bg);z-index:1001}.soso-panel .soso-pad2 .soso-border,.soso-panel .soso-pad2 .soso-grid{stroke:var(--panel-fg);stroke-opacity:.25}.soso-panel .soso-pad2 .soso-label{fill:var(--panel-fg);opacity:.5}.soso-panel .soso-pad2 .soso-indicator{fill:var(--panel-fg)}.soso-panel button.soso-translate{font-weight:bolder}.soso-panel button.soso-translate.soso-selected{cursor:grabbing}.soso-panel input[type=text]{color:var(--value-string);font-family:var(--font-value)}.soso-panel input[type=text].soso-number-input{color:var(--value-number)}.soso-panel input[type=number]::-webkit-inner-spin-button,.soso-panel input[type=number]::-webkit-outer-spin-button{appearance:none;margin:0}.soso-panel input[type=text].soso-fixed{width:60px}.soso-panel .soso-control>.soso-display{line-height:var(--row-height)}.soso-panel .soso-control>.soso-display.soso-monospace{font-family:var(--font-value)}.soso-panel .soso-display a{color:var(--color-link);text-decoration:underline}.soso-panel .soso-display a:hover{text-decoration:none}.soso-panel pre.soso-display{margin:0}.soso-panel input[type=checkbox]{margin:0;appearance:none;border-radius:var(--panel-radius);width:14px;height:14px;text-align:center}.soso-panel input[type=checkbox]:checked:before{content:"";display:flex;height:var(--checkbox-check-height);width:var(--checkbox-check-width);border-bottom:2px solid var(--panel-fg);border-right:2px solid var(--panel-fg);transform:rotate(45deg)}.soso-panel input[type=range]{-webkit-appearance:none;appearance:none;background:transparent;margin:0;padding:0}.soso-panel input[type=range]::-webkit-slider-runnable-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.soso-panel input[type=range]::-moz-range-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.soso-panel input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);margin-top:-4px}.soso-panel input[type=range]::-moz-range-thumb{width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);border:none}.soso-panel input[type=color]{-webkit-appearance:none;border:1px solid var(--panel-border);padding:0;border-radius:var(--panel-radius);height:var(--row-height)}.soso-panel input[type=color]::-webkit-color-swatch-wrapper{padding:0}.soso-panel input[type=color]::-webkit-color-swatch{border:0}.soso-panel canvas.soso-graph{width:100%}';var Et=0,Tt=e=>`node ${Et++}`,pe=e=>{let{id:t=Tt(),nodes:n=[],...o}=e,s={},r={id:t,nodes:[]},i={id:t},l=de(e);for(let p in l)typeof l[p]=="function"?i[p]=l[p]({...l,...e}):i[p]=l[p];return Object.assign(i,o),s[t]=i,n.length>0&&n.forEach(p=>{let[u,c]=pe(p);Object.assign(s,u),r.nodes.push(c)}),[s,r]},je=()=>{let e=document.createElement("div");return e.classList.add("soso-panel-container"),document.body.append(e),e},qe=()=>{if(!document.querySelector("style[data-soso-panel]")){let e=document.createElement("style");e.textContent=$e,e.setAttribute("data-soso-panel","true"),document.head.appendChild(e)}};var Oe=Symbol("all"),W=class{constructor(t,n){let[o,s]=pe(t);this.nodes=o,this.root=s,this.container=n.mount??je(),this.options=n,this.subscribers=new Map,this.raf=null,n.injectStyles&&qe(),this.render()}render(){let t=()=>{ie(_("div",{className:`soso-panel ${this.options.classNames.join(" ")}`,children:_(ee,{nodes:this.nodes,treeNode:this.root,update:this.handleUpdate.bind(this)})}),this.container)};if(!this.options.throttleRendering){t();return}this.options.throttleRendering&&!this.raf&&(this.raf=requestAnimationFrame(()=>{t(),this.raf=null}))}handleUpdate(t,{silent:n=!1,event:o=!1}={}){if(typeof t!="object"){console.warn("could not set values: invalid values object");return}for(let s in t){let r=this.nodes[s];if(!r)continue;let i=t[s];o||(this.nodes[s]={...r,...i}),"value"in i&&!n&&this.notifySubscribers(s,t[s].value)}this.render()}notifySubscribers(t,n){this.subscribers.get(t)?.forEach(o=>o(n)),this.subscribers.get(Oe)?.forEach(o=>o(t,n))}subscribe(t,n){let o=typeof t=="string"?t:Oe,s=typeof n=="function"?n:typeof t=="function"?t:void 0;if(s===void 0){console.warn("could not subscribe: no handler");return}return this.subscribers.has(o)||this.subscribers.set(o,[]),this.subscribers.get(o).push(s),()=>{let r=this.subscribers.get(o),i=r.indexOf(s);i>-1?r.splice(i,1):console.warn("could not unsubscribe: could not find handler")}}set(t,n){let o={};for(let s in t)o[s]={value:t[s]};this.handleUpdate(o,n)}update(t,n){this.handleUpdate(t,{...n,event:!1})}get(){let t={};for(let n in this.nodes){let s=this.nodes[n]?.value;s!==void 0&&(t[n]=s)}return t}destroy(){this.raf&&cancelAnimationFrame(this.raf),ie(null,this.container),this.options.mount||this.container.remove(),this.subscribers.clear(),this.values={}}};var en={create(e,t={}){let n=Array.isArray(e)?{type:"group",label:"controls",nodes:e}:e,o=new W(n,{throttleRendering:!0,injectStyles:!0,classNames:[],...t});return{subscribe:o.subscribe.bind(o),update:o.update.bind(o),set:o.set.bind(o),get:o.get.bind(o),destroy:o.destroy.bind(o)}}};export{en as default,x as register};

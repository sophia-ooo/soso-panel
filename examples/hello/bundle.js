var te={},tn={layout:"row",visible:!0},C=(e,n,a={})=>{te[e]={...tn,...a,component:n}},ze=e=>e in te?!0:(console.warn(`control of type "${e}" is requested but not registered`),!1),an=e=>{if(!ze(e.type))return;let{component:n,...a}=te[e.type];return a},ln=e=>{if(!ze(e.type))return;let{component:n,...a}=te[e.type];return n},ae,y,Xe,rn,I,me,Ye,Ie,Fe,pe,ie,se,on,W={},De=[],sn=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,le=Array.isArray;function M(e,n){for(var a in n)e[a]=n[a];return e}function ce(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function un(e,n,a){var t,r,l,s={};for(l in n)l=="key"?t=n[l]:l=="ref"?r=n[l]:s[l]=n[l];if(arguments.length>2&&(s.children=arguments.length>3?ae.call(arguments,2):a),typeof e=="function"&&e.defaultProps!=null)for(l in e.defaultProps)s[l]===void 0&&(s[l]=e.defaultProps[l]);return G(e,s,t,r,null)}function G(e,n,a,t,r){var l={type:e,props:n,key:a,ref:t,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++Xe,__i:-1,__u:0};return r==null&&y.vnode!=null&&y.vnode(l),l}function F(e){return e.children}function K(e,n){this.props=e,this.context=n}function U(e,n){if(n==null)return e.__?U(e.__,e.__i+1):null;for(var a;n<e.__k.length;n++)if((a=e.__k[n])!=null&&a.__e!=null)return a.__e;return typeof e.type=="function"?U(e):null}function Ue(e){var n,a;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,n=0;n<e.__k.length;n++)if((a=e.__k[n])!=null&&a.__e!=null){e.__e=e.__c.base=a.__e;break}return Ue(e)}}function ge(e){(!e.__d&&(e.__d=!0)&&I.push(e)&&!Z.__r++||me!=y.debounceRendering)&&((me=y.debounceRendering)||Ye)(Z)}function Z(){for(var e,n,a,t,r,l,s,i=1;I.length;)I.length>i&&I.sort(Ie),e=I.shift(),i=I.length,e.__d&&(a=void 0,r=(t=(n=e).__v).__e,l=[],s=[],n.__P&&((a=M({},t)).__v=t.__v+1,y.vnode&&y.vnode(a),_e(n.__P,a,t,n.__n,n.__P.namespaceURI,32&t.__u?[r]:null,l,r??U(t),!!(32&t.__u),s),a.__v=t.__v,a.__.__k[a.__i]=a,Be(l,a,s),a.__e!=r&&Ue(a)));Z.__r=0}function Re(e,n,a,t,r,l,s,i,p,u,c){var o,_,d,b,v,g,f=t&&t.__k||De,m=n.length;for(p=pn(a,n,f,p,m),o=0;o<m;o++)(d=a.__k[o])!=null&&(_=d.__i==-1?W:f[d.__i]||W,d.__i=o,g=_e(e,d,_,r,l,s,i,p,u,c),b=d.__e,d.ref&&_.ref!=d.ref&&(_.ref&&de(_.ref,null,d),c.push(d.ref,d.__c||b,d)),v==null&&b!=null&&(v=b),4&d.__u||_.__k===d.__k?p=$e(d,p,e):typeof d.type=="function"&&g!==void 0?p=g:b&&(p=b.nextSibling),d.__u&=-7);return a.__e=v,p}function pn(e,n,a,t,r){var l,s,i,p,u,c=a.length,o=c,_=0;for(e.__k=new Array(r),l=0;l<r;l++)(s=n[l])!=null&&typeof s!="boolean"&&typeof s!="function"?(p=l+_,(s=e.__k[l]=typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?G(null,s,null,null,null):le(s)?G(F,{children:s},null,null,null):s.constructor==null&&s.__b>0?G(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=e,s.__b=e.__b+1,i=null,(u=s.__i=cn(s,a,p,o))!=-1&&(o--,(i=a[u])&&(i.__u|=2)),i==null||i.__v==null?(u==-1&&(r>c?_--:r<c&&_++),typeof s.type!="function"&&(s.__u|=4)):u!=p&&(u==p-1?_--:u==p+1?_++:(u>p?_--:_++,s.__u|=4))):e.__k[l]=null;if(o)for(l=0;l<c;l++)(i=a[l])!=null&&(2&i.__u)==0&&(i.__e==t&&(t=U(i)),Ve(i,i));return t}function $e(e,n,a){var t,r;if(typeof e.type=="function"){for(t=e.__k,r=0;t&&r<t.length;r++)t[r]&&(t[r].__=e,n=$e(t[r],n,a));return n}e.__e!=n&&(n&&e.type&&!a.contains(n)&&(n=U(e)),a.insertBefore(e.__e,n||null),n=e.__e);do n=n&&n.nextSibling;while(n!=null&&n.nodeType==8);return n}function cn(e,n,a,t){var r,l,s=e.key,i=e.type,p=n[a];if(p===null&&e.key==null||p&&s==p.key&&i==p.type&&(2&p.__u)==0)return a;if(t>(p!=null&&(2&p.__u)==0?1:0))for(r=a-1,l=a+1;r>=0||l<n.length;){if(r>=0){if((p=n[r])&&(2&p.__u)==0&&s==p.key&&i==p.type)return r;r--}if(l<n.length){if((p=n[l])&&(2&p.__u)==0&&s==p.key&&i==p.type)return l;l++}}return-1}function be(e,n,a){n[0]=="-"?e.setProperty(n,a??""):e[n]=a==null?"":typeof a!="number"||sn.test(n)?a:a+"px"}function J(e,n,a,t,r){var l,s;e:if(n=="style")if(typeof a=="string")e.style.cssText=a;else{if(typeof t=="string"&&(e.style.cssText=t=""),t)for(n in t)a&&n in a||be(e.style,n,"");if(a)for(n in a)t&&a[n]==t[n]||be(e.style,n,a[n])}else if(n[0]=="o"&&n[1]=="n")l=n!=(n=n.replace(Fe,"$1")),s=n.toLowerCase(),n=s in e||n=="onFocusOut"||n=="onFocusIn"?s.slice(2):n.slice(2),e.l||(e.l={}),e.l[n+l]=a,a?t?a.u=t.u:(a.u=pe,e.addEventListener(n,l?se:ie,l)):e.removeEventListener(n,l?se:ie,l);else{if(r=="http://www.w3.org/2000/svg")n=n.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(n!="width"&&n!="height"&&n!="href"&&n!="list"&&n!="form"&&n!="tabIndex"&&n!="download"&&n!="rowSpan"&&n!="colSpan"&&n!="role"&&n!="popover"&&n in e)try{e[n]=a??"";break e}catch{}typeof a=="function"||(a==null||a===!1&&n[4]!="-"?e.removeAttribute(n):e.setAttribute(n,n=="popover"&&a==1?"":a))}}function ye(e){return function(n){if(this.l){var a=this.l[n.type+e];if(n.t==null)n.t=pe++;else if(n.t<a.u)return;return a(y.event?y.event(n):n)}}}function _e(e,n,a,t,r,l,s,i,p,u){var c,o,_,d,b,v,g,f,m,k,N,S,P,z,X,A,V,E=n.type;if(n.constructor!=null)return null;128&a.__u&&(p=!!(32&a.__u),l=[i=n.__e=a.__e]),(c=y.__b)&&c(n);e:if(typeof E=="function")try{if(f=n.props,m="prototype"in E&&E.prototype.render,k=(c=E.contextType)&&t[c.__c],N=c?k?k.props.value:c.__:t,a.__c?g=(o=n.__c=a.__c).__=o.__E:(m?n.__c=o=new E(f,N):(n.__c=o=new K(f,N),o.constructor=E,o.render=dn),k&&k.sub(o),o.props=f,o.state||(o.state={}),o.context=N,o.__n=t,_=o.__d=!0,o.__h=[],o._sb=[]),m&&o.__s==null&&(o.__s=o.state),m&&E.getDerivedStateFromProps!=null&&(o.__s==o.state&&(o.__s=M({},o.__s)),M(o.__s,E.getDerivedStateFromProps(f,o.__s))),d=o.props,b=o.state,o.__v=n,_)m&&E.getDerivedStateFromProps==null&&o.componentWillMount!=null&&o.componentWillMount(),m&&o.componentDidMount!=null&&o.__h.push(o.componentDidMount);else{if(m&&E.getDerivedStateFromProps==null&&f!==d&&o.componentWillReceiveProps!=null&&o.componentWillReceiveProps(f,N),!o.__e&&o.shouldComponentUpdate!=null&&o.shouldComponentUpdate(f,o.__s,N)===!1||n.__v==a.__v){for(n.__v!=a.__v&&(o.props=f,o.state=o.__s,o.__d=!1),n.__e=a.__e,n.__k=a.__k,n.__k.some(function(Y){Y&&(Y.__=n)}),S=0;S<o._sb.length;S++)o.__h.push(o._sb[S]);o._sb=[],o.__h.length&&s.push(o);break e}o.componentWillUpdate!=null&&o.componentWillUpdate(f,o.__s,N),m&&o.componentDidUpdate!=null&&o.__h.push(function(){o.componentDidUpdate(d,b,v)})}if(o.context=N,o.props=f,o.__P=e,o.__e=!1,P=y.__r,z=0,m){for(o.state=o.__s,o.__d=!1,P&&P(n),c=o.render(o.props,o.state,o.context),X=0;X<o._sb.length;X++)o.__h.push(o._sb[X]);o._sb=[]}else do o.__d=!1,P&&P(n),c=o.render(o.props,o.state,o.context),o.state=o.__s;while(o.__d&&++z<25);o.state=o.__s,o.getChildContext!=null&&(t=M(M({},t),o.getChildContext())),m&&!_&&o.getSnapshotBeforeUpdate!=null&&(v=o.getSnapshotBeforeUpdate(d,b)),A=c,c!=null&&c.type===F&&c.key==null&&(A=je(c.props.children)),i=Re(e,le(A)?A:[A],n,a,t,r,l,s,i,p,u),o.base=n.__e,n.__u&=-161,o.__h.length&&s.push(o),g&&(o.__E=o.__=null)}catch(Y){if(n.__v=null,p||l!=null)if(Y.then){for(n.__u|=p?160:128;i&&i.nodeType==8&&i.nextSibling;)i=i.nextSibling;l[l.indexOf(i)]=null,n.__e=i}else for(V=l.length;V--;)ce(l[V]);else n.__e=a.__e,n.__k=a.__k;y.__e(Y,n,a)}else l==null&&n.__v==a.__v?(n.__k=a.__k,n.__e=a.__e):i=n.__e=_n(a.__e,n,a,t,r,l,s,p,u);return(c=y.diffed)&&c(n),128&n.__u?void 0:i}function Be(e,n,a){for(var t=0;t<a.length;t++)de(a[t],a[++t],a[++t]);y.__c&&y.__c(n,e),e.some(function(r){try{e=r.__h,r.__h=[],e.some(function(l){l.call(r)})}catch(l){y.__e(l,r.__v)}})}function je(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:le(e)?e.map(je):M({},e)}function _n(e,n,a,t,r,l,s,i,p){var u,c,o,_,d,b,v,g=a.props,f=n.props,m=n.type;if(m=="svg"?r="http://www.w3.org/2000/svg":m=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),l!=null){for(u=0;u<l.length;u++)if((d=l[u])&&"setAttribute"in d==!!m&&(m?d.localName==m:d.nodeType==3)){e=d,l[u]=null;break}}if(e==null){if(m==null)return document.createTextNode(f);e=document.createElementNS(r,m,f.is&&f),i&&(y.__m&&y.__m(n,l),i=!1),l=null}if(m==null)g===f||i&&e.data==f||(e.data=f);else{if(l=l&&ae.call(e.childNodes),g=a.props||W,!i&&l!=null)for(g={},u=0;u<e.attributes.length;u++)g[(d=e.attributes[u]).name]=d.value;for(u in g)if(d=g[u],u!="children"){if(u=="dangerouslySetInnerHTML")o=d;else if(!(u in f)){if(u=="value"&&"defaultValue"in f||u=="checked"&&"defaultChecked"in f)continue;J(e,u,null,d,r)}}for(u in f)d=f[u],u=="children"?_=d:u=="dangerouslySetInnerHTML"?c=d:u=="value"?b=d:u=="checked"?v=d:i&&typeof d!="function"||g[u]===d||J(e,u,d,g[u],r);if(c)i||o&&(c.__html==o.__html||c.__html==e.innerHTML)||(e.innerHTML=c.__html),n.__k=[];else if(o&&(e.innerHTML=""),Re(n.type=="template"?e.content:e,le(_)?_:[_],n,a,t,m=="foreignObject"?"http://www.w3.org/1999/xhtml":r,l,s,l?l[0]:a.__k&&U(a,0),i,p),l!=null)for(u=l.length;u--;)ce(l[u]);i||(u="value",m=="progress"&&b==null?e.removeAttribute("value"):b!=null&&(b!==e[u]||m=="progress"&&!b||m=="option"&&b!=g[u])&&J(e,u,b,g[u],r),u="checked",v!=null&&v!=e[u]&&J(e,u,v,g[u],r))}return e}function de(e,n,a){try{if(typeof e=="function"){var t=typeof e.__u=="function";t&&e.__u(),t&&n==null||(e.__u=e(n))}else e.current=n}catch(r){y.__e(r,a)}}function Ve(e,n,a){var t,r;if(y.unmount&&y.unmount(e),(t=e.ref)&&(t.current&&t.current!=e.__e||de(t,null,n)),(t=e.__c)!=null){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(l){y.__e(l,n)}t.base=t.__P=null}if(t=e.__k)for(r=0;r<t.length;r++)t[r]&&Ve(t[r],n,a||typeof e.type!="function");a||ce(e.__e),e.__c=e.__=e.__e=void 0}function dn(e,n,a){return this.constructor(e,a)}function xe(e,n,a){var t,r,l,s;n==document&&(n=document.documentElement),y.__&&y.__(e,n),r=(t=typeof a=="function")?null:a&&a.__k||n.__k,l=[],s=[],_e(n,e=(!t&&a||n).__k=un(F,null,[e]),r||W,W,n.namespaceURI,!t&&a?[a]:r?null:n.firstChild?ae.call(n.childNodes):null,l,!t&&a?a:r?r.__e:n.firstChild,t,s),Be(l,e,s)}ae=De.slice,y={__e:function(e,n,a,t){for(var r,l,s;n=n.__;)if((r=n.__c)&&!r.__)try{if((l=r.constructor)&&l.getDerivedStateFromError!=null&&(r.setState(l.getDerivedStateFromError(e)),s=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(e,t||{}),s=r.__d),s)return r.__E=r}catch(i){e=i}throw e}},Xe=0,rn=function(e){return e!=null&&e.constructor==null},K.prototype.setState=function(e,n){var a;a=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=M({},this.state),typeof e=="function"&&(e=e(M({},a),this.props)),e&&M(a,e),e!=null&&this.__v&&(n&&this._sb.push(n),ge(this))},K.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ge(this))},K.prototype.render=F,I=[],Ye=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ie=function(e,n){return e.__v.__b-n.__v.__b},Z.__r=0,Fe=/(PointerCapture)$|Capture$/i,pe=0,ie=ye(!1),se=ye(!0),on=0;var hn=0,Bn=Array.isArray;function h(e,n,a,t,r,l){n||(n={});var s,i,p=n;if("ref"in p)for(i in p={},n)i=="ref"?s=n[i]:p[i]=n[i];var u={type:e,props:p,key:a,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--hn,__i:-1,__u:0,__source:r,__self:l};if(typeof e=="function"&&(s=e.defaultProps))for(i in s)p[i]===void 0&&(p[i]=s[i]);return y.vnode&&y.vnode(u),u}var fn=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id];return h("button",{type:"button",onClick:()=>a({[t.id]:{value:!0}},{event:!0}),children:t.text??t.id})};C("button",fn,{label:null});var q,x,oe,we,ee=0,We=[],w=y,ke=w.__b,Ne=w.__r,Se=w.diffed,Ee=w.__c,Ce=w.unmount,Te=w.__;function he(e,n){w.__h&&w.__h(x,e,ee||n),ee=0;var a=x.__H||(x.__H={__:[],__h:[]});return e>=a.__.length&&a.__.push({}),a.__[e]}function L(e){return ee=1,vn(Oe,e)}function vn(e,n,a){var t=he(q++,2);if(t.t=e,!t.__c&&(t.__=[a?a(n):Oe(void 0,n),function(i){var p=t.__N?t.__N[0]:t.__[0],u=t.t(p,i);p!==u&&(t.__N=[u,t.__[1]],t.__c.setState({}))}],t.__c=x,!x.__f)){var r=function(i,p,u){if(!t.__c.__H)return!0;var c=t.__c.__H.__.filter(function(_){return!!_.__c});if(c.every(function(_){return!_.__N}))return!l||l.call(this,i,p,u);var o=t.__c.props!==i;return c.forEach(function(_){if(_.__N){var d=_.__[0];_.__=_.__N,_.__N=void 0,d!==_.__[0]&&(o=!0)}}),l&&l.call(this,i,p,u)||o};x.__f=!0;var l=x.shouldComponentUpdate,s=x.componentWillUpdate;x.componentWillUpdate=function(i,p,u){if(this.__e){var c=l;l=void 0,r(i,p,u),l=c}s&&s.call(this,i,p,u)},x.shouldComponentUpdate=r}return t.__N||t.__}function R(e,n){var a=he(q++,3);!w.__s&&qe(a.__H,n)&&(a.__=e,a.u=n,x.__H.__h.push(a))}function mn(e){return ee=5,gn(function(){return{current:e}},[])}function gn(e,n){var a=he(q++,7);return qe(a.__H,n)&&(a.__=e(),a.__H=n,a.__h=e),a.__}function bn(){for(var e;e=We.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Q),e.__H.__h.forEach(ue),e.__H.__h=[]}catch(n){e.__H.__h=[],w.__e(n,e.__v)}}w.__b=function(e){x=null,ke&&ke(e)},w.__=function(e,n){e&&n.__k&&n.__k.__m&&(e.__m=n.__k.__m),Te&&Te(e,n)},w.__r=function(e){Ne&&Ne(e),q=0;var n=(x=e.__c).__H;n&&(oe===x?(n.__h=[],x.__h=[],n.__.forEach(function(a){a.__N&&(a.__=a.__N),a.u=a.__N=void 0})):(n.__h.forEach(Q),n.__h.forEach(ue),n.__h=[],q=0)),oe=x},w.diffed=function(e){Se&&Se(e);var n=e.__c;n&&n.__H&&(n.__H.__h.length&&(We.push(n)!==1&&we===w.requestAnimationFrame||((we=w.requestAnimationFrame)||yn)(bn)),n.__H.__.forEach(function(a){a.u&&(a.__H=a.u),a.u=void 0})),oe=x=null},w.__c=function(e,n){n.some(function(a){try{a.__h.forEach(Q),a.__h=a.__h.filter(function(t){return!t.__||ue(t)})}catch(t){n.some(function(r){r.__h&&(r.__h=[])}),n=[],w.__e(t,a.__v)}}),Ee&&Ee(e,n)},w.unmount=function(e){Ce&&Ce(e);var n,a=e.__c;a&&a.__H&&(a.__H.__.forEach(function(t){try{Q(t)}catch(r){n=r}}),a.__H=void 0,n&&w.__e(n,a.__v))};var Pe=typeof requestAnimationFrame=="function";function yn(e){var n,a=function(){clearTimeout(t),Pe&&cancelAnimationFrame(n),setTimeout(e)},t=setTimeout(a,35);Pe&&(n=requestAnimationFrame(a))}function Q(e){var n=x,a=e.__c;typeof a=="function"&&(e.__c=void 0,a()),x=n}function ue(e){var n=x;e.__c=e.__(),x=n}function qe(e,n){return!e||e.length!==n.length||n.some(function(a,t){return a!==e[t]})}function Oe(e,n){return typeof n=="function"?n(e):n}var Ae=e=>e.trim()==="",Me=e=>isFinite(e),xn=(e,n)=>String(e)!==n,wn=(e,n,a)=>e>=n&&e<=a,kn=(e,n,a)=>Math.min(Math.max(e,n),a),ne=({value:e,min:n=-1/0,max:a=1/0,commit:t})=>{let[r,l]=L(String(e)),[s,i]=L(e);R(()=>{l(String(e)),i(e)},[e]);function p(c){let o=String(c);if(l(o),Ae(o))return;let _=Number(o);!Me(_)||!wn(_,n,a)||xn(_,o)||(i(_),t(_))}function u(){if(Ae(r)||!Me(Number(r))){l(String(s));return}let c=Number(r),o=kn(c,n,a);l(String(o)),i(o),t(o)}return{value:e,text:r,setValue:p,handleBlur:u}},re=e=>Array.isArray(e)&&e.every(n=>n!=null&&typeof n=="object"&&!Array.isArray(n)&&"label"in n&&"value"in n)?e:Array.isArray(e)?e.map(n=>({label:String(n),value:n})):e&&typeof e=="object"?Object.entries(e).map(([n,a])=>({label:n,value:a})):[],Nn=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id],r=re(t.options).map(({label:l,value:s},i)=>{let p=t.value===s?"selected":"";return h("button",{onClick:()=>a({[t.id]:{value:s}}),className:`${p}`,type:"button",children:l},l)});return h("div",{className:"buttons",children:r})};C("buttons",Nn,{value:e=>re(e.options)[0]?.value});var Sn=e=>"#ffffff",En=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id],[r,l]=L(t.value),[s,i]=L(t.value);R(()=>{l(t.value)},[t.value]);let p=o=>o.startsWith("#")&&o.length===7&&CSS.supports("color",o),u=o=>{let _=o.currentTarget.value,d=p(_)?_:s;a({[t.id]:{value:d}}),l(d)},c=o=>{let _=o.currentTarget.value;p(_)&&(a({[t.id]:{value:_}}),i(_))};return h(F,{children:[h("input",{type:"color",value:r,onInput:c,className:"color-picker"}),h("input",{type:"text",className:"fixed",size:"7",value:r,onInput:c,onChange:u})]})};C("color",En,{value:Sn});var Cn=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id];switch(t.format){case"monospace":return h("span",{className:"display monospace",children:t.value});case"block":return h("pre",{className:"display monospace",children:t.value});case"html":return h("span",{className:"display",dangerouslySetInnerHTML:{__html:t.value??""}});default:return h("span",{className:"display",children:t.value})}};C("display",Cn,{value:"",format:"text"});var Tn=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id],r=mn(null),[l,s]=L(Array(t.samples).fill(0)),[i,p]=L({min:null,max:null});return R(()=>{s(u=>[...u,t.value].slice(-t.samples)),p(u=>({min:u.min===null?t.value:Math.min(u.min,t.value),max:u.max===null?t.value:Math.max(u.max,t.value)}))},[t]),R(()=>{let u=r.current;if(!u)return;let c=u.getContext("2d"),o=u.getBoundingClientRect(),_=window.devicePixelRatio||1,d=o.width,b=t.height;u.width=d*_,u.height=b*_,c.scale(_,_),u.style.width=d+"px",u.style.height=b+"px",c.clearRect(0,0,d,b);let v=u.closest(".soso-panel"),g=getComputedStyle(v).getPropertyValue("--panel-fg").trim()||"#aaa",f=t.min??i.min??0,m=t.max??i.max??1,k=m-f||1,N=1/(t.samples-1)*d;c.fillStyle=g,c.globalAlpha=.5,c.beginPath(),c.moveTo(0,b),l.forEach((S,P)=>{let z=(S-f)/k*b,X=P*N,A=b-z;c.lineTo(X,A)}),c.lineTo(d,b),c.fill(),c.globalAlpha=1,c.font="10px ui-monospace, monospace",c.textBaseline="top",c.textAlign="left",c.fillText(m,3,0),c.textBaseline="bottom",c.fillText(f,3,b)},[l,i,t]),h("canvas",{className:"graph",ref:r,height:t.height})};C("graph",Tn,{height:60,samples:60});var Je=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id];if(!t.visible)return null;let r=ln(t);if(!r)return null;let l=h(r,{nodes:e,treeNode:n,update:a});if(t.layout==="block")return l;let s=!(t.label===""||t.label===null);return h("div",{className:"row",role:"group","aria-label":t.label??t.id,children:[s&&h("span",{className:"label",children:t.label??t.id}),h("div",{className:"control",children:l})]})},Pn=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id],r=n.nodes.map((p,u)=>h(Je,{nodes:e,treeNode:p,update:a},p.id)),l=t.expanded?"expanded":"collapsed",s=t.showLabel?"show-label":"hide-label",i=!(t.label===""||t.label===null);return h("div",{className:`group ${l} ${s}`,children:[i&&h("span",{className:"label",onClick:()=>{t.expandable&&a({[t.id]:{expanded:!t.expanded}})},children:[t.expandable&&h("span",{className:"icon",children:"\u2303"}),t.label??t.id]}),h("div",{className:"container",children:r})]})};C("group",Pn,{layout:"block",expandable:!0,expanded:!0});var An=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id],{text:r,setValue:l,handleBlur:s}=ne({value:t.value,min:t.min,max:t.max,commit:i=>a({[t.id]:{value:i}})});return h("input",{className:"number-input",type:"text",value:r,onInput:i=>l(i.currentTarget.value),onChange:s})};C("number",An,{value:()=>0});var Le=(e,n)=>{let a=1/n;return Math.round(e*a)/a},Mn=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id],{x:r,y:l}=t.value,[s,i]=L(!1),[p,u]=L(null),[c,o]=L({height:176,width:176,space:6,radius:2});R(()=>{let v=document.querySelector(".soso-panel");if(!v)return;let g=getComputedStyle(v),f=g.getPropertyValue("--panel-width"),m=g.getPropertyValue("--label-width"),k=g.getPropertyValue("--panel-radius"),N=g.getPropertyValue("--panel-space"),S=parseFloat(f)-parseFloat(m)-2*parseFloat(N),P=parseFloat(k),z=parseFloat(N);o({width:S,height:S,radius:P,space:z})},[]);let _=ne({value:t.value.x,min:t.minX,max:t.maxX,commit:v=>a({[t.id]:{value:{...t.value,x:v}}})}),d=ne({value:t.value.y,min:t.minY,max:t.maxY,commit:v=>a({[t.id]:{value:{...t.value,y:v}}})});R(()=>{if(!s||!p)return;let v=document.body.style.cursor;document.body.style.cursor="grabbing";let g=k=>{let N=k.clientX??k.touches?.[0]?.clientX,S=k.clientY??k.touches?.[0]?.clientY;if(N===void 0||S===void 0)return;let P=N-p.pointerX,z=S-p.pointerY,X=p.valueX+P*t.scale,A=p.valueY+z*t.scale,V=Math.max(t.minX,Math.min(t.maxX,X)),E=Math.max(t.minY,Math.min(t.maxY,A)),Y=Le(V,t.step),nn=Le(E,t.step);a({[t.id]:{value:{x:Y,y:nn}}})},f=()=>{i(!1),u(null)},m=k=>(k.preventDefault(),!1);return document.addEventListener("mousemove",g),document.addEventListener("mouseup",f),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",f),()=>{document.body.style.cursor=v,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",f)}},[s,p,t]);let b=(v,g=null)=>{let f=v.clientX??v.touches?.[0]?.clientX,m=v.clientY??v.touches?.[0]?.clientY;i(!0),u({pointerX:f,pointerY:m,valueX:g?.x??t.value.x,valueY:g?.y??t.value.y})};return h(F,{children:[h("button",{onMouseDown:v=>{v.preventDefault(),b(v)},onTouchStart:v=>{v.preventDefault(),b(v)},className:`translate ${s?"selected":""}`,type:"button",style:{touchAction:"none",userSelect:"none"},children:"\u2316"}),h("input",{className:"number-input fixed",type:"text",size:"7",value:_.text,onInput:v=>_.setValue(v.currentTarget.value),onChange:_.handleBlur}),h("input",{className:"number-input fixed",type:"text",size:"7",value:d.text,onInput:v=>d.setValue(v.currentTarget.value),onChange:d.handleBlur}),s&&h("div",{className:"pad2",children:h("svg",{width:c.width,height:c.height,style:{position:"absolute",top:0,left:0,borderRadius:c.radius},children:[h("rect",{width:c.width,height:c.height,fill:"transparent",className:"border",rx:c.radius}),h("line",{x1:c.width/2,y1:0,x2:c.width/2,y2:c.height,className:"grid"}),h("line",{x1:0,y1:c.height/2,x2:c.width,y2:c.height/2,className:"grid"}),h("text",{x:c.space,y:c.space,className:"label","dominant-baseline":"hanging","font-size":"10",children:[t.minX,",",t.minY]}),h("text",{x:c.width-c.space,y:c.space,"dominant-baseline":"hanging",className:"label","font-size":"10","text-anchor":"end",children:[t.maxX,",",t.minY]}),h("text",{x:c.space,y:c.height-c.space,className:"label","font-size":"10",children:[t.minX,",",t.maxY]}),h("text",{x:c.width-c.space,y:c.height-c.space,className:"label","font-size":"10","text-anchor":"end",children:[t.maxX,",",t.maxY]}),h("circle",{cx:(r-t.minX)/(t.maxX-t.minX)*c.width,cy:(l-t.minY)/(t.maxY-t.minY)*c.height,r:6,className:"indicator"})]})})]})};C("pad2",Mn,{value:e=>({x:e.minX+(e.maxX-e.minX)*.5,y:e.minY+(e.maxY-e.minY)*.5}),scale:.01,step:.01,minX:-1,maxX:1,minY:-1,maxY:1});var Ln=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id],{text:r,setValue:l,handleBlur:s}=ne({value:t.value,min:t.min,max:t.max,commit:i=>a({[t.id]:{value:i}})});return h(F,{children:[h("input",{type:"range",value:r,min:t.min,max:t.max,step:t.step??1,onInput:i=>l(i.currentTarget.value)}),h("input",{type:"text",size:"7",className:"number-input fixed",value:r,onInput:i=>l(i.currentTarget.value),onChange:s})]})};C("range",Ln,{value:e=>e.min??0});var Hn=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id],r=re(t.options),l=p=>{let u=Number(p.currentTarget.value),c=r[u].value;a({[t.id]:{value:c}})},s=r.map(({label:p},u)=>h("option",{value:u,children:p},p)),i=r.findIndex(({value:p})=>p===t.value);return h("select",{value:i<0?"":i,onChange:l,children:s})};C("select",Hn,{value:e=>re(e.options)[0]?.value});var zn=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id],r=l=>{a({[t.id]:{value:l.currentTarget.value}})};return t.multiline?h("textarea",{value:t.value,onInput:r,rows:t.rows}):h("input",{type:"text",value:t.value,onInput:r})};C("text",zn,{value:"",multiline:!1,rows:4});var Xn=({nodes:e,treeNode:n,update:a})=>{let t=e[n.id];return h("input",{type:"checkbox",checked:t.value,onInput:r=>a({[t.id]:{value:r.currentTarget.checked}})})};C("toggle",Xn,{value:e=>!1});var Yn='.soso-panel-container{position:fixed;top:0;right:0}.soso-panel{--panel-bg: hsl(230 7% 10%);--panel-fg: hsl(230 10% 75%);--panel-border: hsl(230 9% 18%);--panel-hover: hsl(230 9% 26%);--panel-pressed: hsl(230 7% 16%);--panel-low-emphasis: hsl(230 4% 55%);--panel-focus: var(--panel-fg);--panel-selection-fg: var(--panel-bg);--panel-selection-bg: var(--panel-fg);--value-number: hsl(220 80% 65%);--value-string: hsl(139 45% 56%);--panel-space: 4px;--panel-radius: 2px;--panel-width: 256px;--label-width: 80px;--row-height: 20px;--font-ui: system-ui, -apple-system, sans-serif;--font-value: ui-monospace, monospace;--font-size-normal: 11px;--line-height-normal: 1.4;--color-link: var(--value-number);--panel-tween-func: cubic-bezier(.25, .8, .5, 1);--panel-tween-duration: .2s;--checkbox-check-width: 3px;--checkbox-check-height: 9px;width:var(--panel-width);color:var(--panel-fg);font-family:var(--font-ui);font-size:var(--font-size-normal);line-height:var(--line-height-normal);box-sizing:border-box;font-variant-numeric:tabular-nums}.soso-panel .row{display:flex;flex-direction:row;gap:var(--panel-space);padding:var(--panel-space) var(--panel-space)}.soso-panel .row+.row{padding-top:calc(var(--panel-space) * .5)}.soso-panel .row:has(+.row){padding-bottom:calc(var(--panel-space) * .5)}.soso-panel .container .container{border-bottom:1px solid var(--panel-border)}.soso-panel .row .label{display:flex;align-self:flex-start;align-items:center;line-height:1.2;min-height:20px;min-width:0;user-select:none;color:var(--panel-low-emphasis);flex:0 0 var(--label-width)}.soso-panel .group{display:flex;flex-direction:column;background:var(--panel-bg);border-radius:var(--panel-radius)}.soso-panel-container>.soso-panel>.group>.label{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.soso-panel .group>.label{display:flex;align-items:center;user-select:none;background:var(--panel-border);border-radius:var(--panel-radius);height:var(--row-height);padding-left:var(--panel-space);gap:var(--panel-space)}.soso-panel .group>.label:has(>.icon){cursor:pointer}.soso-panel .group>.label>.icon{font-weight:700;font-size:10px;cursor:pointer}@media (prefers-reduced-motion: no-preference){.soso-panel .group>.label>.icon{transition:transform var(--panel-tween-duration) var(--panel-tween-func)}}.soso-panel .group.expanded>.label>.icon{transform:rotate(180deg)}.soso-panel .group>.container{flex-direction:column;overflow:hidden;display:none}.soso-panel .group.expanded>.container{display:flex}@supports (interpolate-size: allow-keywords){.soso-panel .group>.container{display:flex;interpolate-size:allow-keywords;height:0;opacity:0}@media (prefers-reduced-motion: no-preference){.soso-panel .group>.container{transition:height var(--panel-tween-duration) var(--panel-tween-func),padding var(--panel-tween-duration) var(--panel-tween-func),opacity var(--panel-tween-duration) var(--panel-tween-func)}}.soso-panel .group.expanded>.container{height:auto;opacity:1}}.soso-panel-container>.soso-panel{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.soso-panel .row .control{flex:1 1 auto;display:flex;justify-content:flex-start;align-items:center;min-height:var(--row-height);gap:var(--panel-space)}.soso-panel button,.soso-panel input,.soso-panel select,.soso-panel textarea{font-size:inherit;font-family:inherit;width:100%;box-sizing:border-box;border:1px solid transparent;padding:0 var(--panel-space);border-radius:var(--panel-radius);background:var(--panel-border);color:var(--panel-fg)}.soso-panel button,.soso-panel select,.soso-panel input[type=text],.soso-panel input[type=range]{min-height:var(--row-height)}.soso-panel input[type=color]{height:var(--row-height)}.soso-panel button,.soso-panel select,.soso-panel input[type=checkbox],.soso-panel input[type=range],.soso-panel input[type=color]{cursor:pointer}.soso-panel input[type=text],.soso-panel textarea{cursor:text}.soso-panel button:focus-visible,.soso-panel select:focus-visible,.soso-panel input:focus-visible,.soso-panel textarea:focus-visible{outline:2px solid var(--panel-focus);outline-offset:0px}.soso-panel button:focus:not(:focus-visible),.soso-panel select:focus:not(:focus-visible),.soso-panel input:focus:not(:focus-visible),.soso-panel textarea:focus:not(:focus-visible){outline:none}.soso-panel button:hover:not(:active):not(.selected),.soso-panel input:hover,.soso-panel select:hover,.soso-panel textarea:hover{background:var(--panel-hover)}.soso-panel button:active,.soso-panel button.selected{background:var(--panel-fg);color:var(--panel-bg);border-radius:var(--panel-radius)}.soso-panel input::selection,.soso-panel textarea::selection{background:var(--panel-selection-bg);color:var(--panel-selection-fg)}.soso-panel textarea{resize:vertical;min-height:calc(var(--row-height) * 2 + var(--panel-space));line-height:var(--line-height-normal);color:var(--value-string);font-family:var(--font-value)}.soso-panel .buttons{display:flex;flex-direction:row;flex:1;gap:var(--panel-space)}.soso-panel .pad2{position:absolute;align-self:flex-start;margin-top:calc(var(--row-height) + var(--panel-space));width:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));height:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));background:var(--panel-bg);z-index:1001}.soso-panel .pad2 .border,.soso-panel .pad2 .grid{stroke:var(--panel-fg);stroke-opacity:.25}.soso-panel .pad2 .label{fill:var(--panel-fg);opacity:.5}.soso-panel .pad2 .indicator{fill:var(--panel-fg)}.soso-panel button.translate{font-weight:bolder}.soso-panel button.translate.selected{cursor:grabbing}.soso-panel input[type=text]{color:var(--value-string);font-family:var(--font-value)}.soso-panel input[type=text].number-input{color:var(--value-number)}.soso-panel input[type=number]::-webkit-inner-spin-button,.soso-panel input[type=number]::-webkit-outer-spin-button{appearance:none;margin:0}.soso-panel input[type=text].fixed{width:60px}.soso-panel .control>.display{line-height:var(--row-height)}.soso-panel .control>.display.monospace{font-family:var(--font-value)}.soso-panel .display a{color:var(--color-link);text-decoration:underline}.soso-panel .display a:hover{text-decoration:none}.soso-panel pre.display{margin:0}.soso-panel input[type=checkbox]{margin:0;appearance:none;border-radius:var(--panel-radius);width:14px;height:14px;text-align:center}.soso-panel input[type=checkbox]:checked:before{content:"";display:flex;height:var(--checkbox-check-height);width:var(--checkbox-check-width);border-bottom:2px solid var(--panel-fg);border-right:2px solid var(--panel-fg);transform:rotate(45deg)}.soso-panel input[type=range]{-webkit-appearance:none;appearance:none;background:transparent;margin:0;padding:0}.soso-panel input[type=range]::-webkit-slider-runnable-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.soso-panel input[type=range]::-moz-range-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.soso-panel input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);margin-top:-4px}.soso-panel input[type=range]::-moz-range-thumb{width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);border:none}.soso-panel input[type=color]{-webkit-appearance:none;border:1px solid var(--panel-border);padding:0;border-radius:var(--panel-radius);height:var(--row-height)}.soso-panel input[type=color]::-webkit-color-swatch-wrapper{padding:0}.soso-panel input[type=color]::-webkit-color-swatch{border:0}.soso-panel canvas.graph{width:100%}',In=0,Fn=e=>`node ${In++}`,Ge=e=>{let{id:n=Fn(),nodes:a=[],...t}=e,r={},l={id:n,nodes:[]},s={id:n},i=an(e);for(let p in i)typeof i[p]=="function"?s[p]=i[p]({...i,...e}):s[p]=i[p];return Object.assign(s,t),r[n]=s,a.length>0&&a.forEach(p=>{let[u,c]=Ge(p);Object.assign(r,u),l.nodes.push(c)}),[r,l]},Dn=()=>{let e=document.createElement("div");return e.classList.add("soso-panel-container"),document.body.append(e),e},Un=()=>{if(!document.querySelector("style[data-soso-panel]")){let e=document.createElement("style");e.textContent=Yn,e.setAttribute("data-soso-panel","true"),document.head.appendChild(e)}},He=Symbol("all"),Rn=class{constructor(e,n){let[a,t]=Ge(e);this.nodes=a,this.root=t,this.container=n.mount??Dn(),this.options=n,this.subscribers=new Map,this.raf=null,n.injectStyles&&Un(),this.render()}render(){let e=()=>{xe(h("div",{className:`soso-panel ${this.options.classNames.join(" ")}`,children:h(Je,{nodes:this.nodes,treeNode:this.root,update:this.handleUpdate.bind(this)})}),this.container)};if(!this.options.throttleRendering){e();return}this.options.throttleRendering&&!this.raf&&(this.raf=requestAnimationFrame(()=>{e(),this.raf=null}))}handleUpdate(e,{silent:n=!1,event:a=!1}={}){if(typeof e!="object"){console.warn("could not set values: invalid values object");return}for(let t in e){let r=this.nodes[t];if(!r)continue;let l=e[t];a||(this.nodes[t]={...r,...l}),"value"in l&&!n&&this.notifySubscribers(t,e[t].value)}this.render()}notifySubscribers(e,n){this.subscribers.get(e)?.forEach(a=>a(n)),this.subscribers.get(He)?.forEach(a=>a(e,n))}subscribe(e,n){let a=typeof e=="string"?e:He,t=typeof n=="function"?n:typeof e=="function"?e:void 0;if(t===void 0){console.warn("could not subscribe: no handler");return}return this.subscribers.has(a)||this.subscribers.set(a,[]),this.subscribers.get(a).push(t),()=>{let r=this.subscribers.get(a),l=r.indexOf(t);l>-1?r.splice(l,1):console.warn("could not unsubscribe: could not find handler")}}set(e,n){let a={};for(let t in e)a[t]={value:e[t]};this.handleUpdate(a,n)}update(e,n){this.handleUpdate(e,{...n,event:!1})}get(){let e={};for(let n in this.nodes){let a=this.nodes[n]?.value;a!==void 0&&(e[n]=a)}return e}destroy(){this.raf&&cancelAnimationFrame(this.raf),xe(null,this.container),this.options.mount||this.container.remove(),this.subscribers.clear(),this.values={}}},Ke={create(e,n={}){let a=Array.isArray(e)?{type:"group",label:"controls",nodes:e}:e,t=new Rn(a,{throttleRendering:!0,injectStyles:!0,classNames:[],...n});return{subscribe:t.subscribe.bind(t),update:t.update.bind(t),set:t.set.bind(t),get:t.get.bind(t),destroy:t.destroy.bind(t)}}};var O=Ke.create({id:"hello, soso-panel",type:"group",nodes:[{id:"text",type:"text",value:"soso"},{id:"fontSize",type:"range",label:"font size",value:200,min:100,max:1e3,step:50},{id:"maxBubbles",type:"range",label:"# bubbles",value:380,min:0,max:1e3,step:40},{id:"bubbleRadius",type:"range",label:"radius",value:10,min:0,max:100},{id:"bubbleLifeVariance",type:"range",label:"life variance",value:5,min:0,max:100},{id:"bubbleColor",type:"color",label:"color",value:"#ff0055"},{id:"wind",type:"pad2",value:{x:0,y:-.05}},{id:"shadowColor",type:"color",label:"shadow color",value:"#debaba"},{id:"shadow",type:"pad2",label:"shadow offset",value:{x:10,y:10},minX:-20,maxX:20,minY:-20,maxY:20,scale:.1},{id:"showEvents",type:"toggle",label:"show events",value:!1},{id:"sampleInterval",type:"range",label:"sample interval",value:3,min:1,max:20},{id:"numSamples",type:"display",label:"# samples",value:0}]}),T=document.createElement("canvas"),j=document.createElement("canvas"),D=T.getContext("2d",{willReadFrequently:!0}),H=j.getContext("2d");document.getElementById("canvas-container").append(j);var B=[],$=[],Qe=()=>{T.width=j.width=window.innerWidth,T.height=j.height=window.innerHeight},$n=(e,n,a)=>{D.clearRect(0,0,T.width,T.height),D.font=`${n}px sans-serif`,D.fillStyle="black",D.textAlign="center",D.textBaseline="middle",D.fillText(e,T.width/2,T.height/2),B=[];let t=D.getImageData(0,0,T.width,T.height);for(let r=0;r<T.height;r+=a)for(let l=0;l<T.width;l+=a)t.data[(r*T.width+l)*4+3]>0&&B.push({x:l,y:r});O.set({numSamples:B.length},{silent:!0})},Ze=()=>{let{bubbleLifeVariance:e,shadowColor:n,bubbleColor:a,bubbleRadius:t,maxBubbles:r,wind:l,shadow:s}=O.get();for(H.clearRect(0,0,j.width,j.height);$.length<r&&B.length>0;){let i=B[Math.floor(Math.random()*B.length)];$.push({x:i.x,y:i.y,life:0,maxLife:5+Math.random()*e})}$=$.filter(i=>{i.life+=.1,i.x+=l.x*i.life,i.y+=l.y*i.life;let p=i.life/i.maxLife;return i.radius=Math.sin(p*Math.PI)*t,p<1}),H.fillStyle=n,$.forEach(i=>{H.beginPath(),H.arc(i.x+s.x,i.y+s.y,i.radius,0,2*Math.PI),H.fill()}),H.fillStyle=a,$.forEach(i=>{H.beginPath(),H.arc(i.x,i.y,i.radius,0,2*Math.PI),H.fill()}),requestAnimationFrame(Ze)},fe=document.getElementById("events"),en=e=>{let n=document.createElement("div");n.textContent=`${new Date().toLocaleString("en-US",{})} ${e}`,fe.append(n)},ve=()=>{let{text:e,fontSize:n,sampleInterval:a}=O.get();$n(e,n,a)};Qe();ve();en("use the panel. events will appear here.");window.addEventListener("resize",()=>{Qe(),ve()});O.subscribe((e,n)=>{ve(),en(`${e}: ${JSON.stringify(n)}`)});O.subscribe("showEvents",e=>e?fe.classList.add("show"):fe.classList.remove("show"));Ze();

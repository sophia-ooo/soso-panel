var ne={},nt={layout:"row",visible:!0},C=(e,t,o={})=>{ne[e]={...nt,...o,component:t}},ze=e=>e in ne?!0:(console.warn(`control of type "${e}" is requested but not registered`),!1),ot=e=>{if(!ze(e.type))return;let{component:t,...o}=ne[e.type];return o},at=e=>{if(!ze(e.type))return;let{component:t,...o}=ne[e.type];return t},oe,y,Xe,lt,I,me,Ye,Ie,Fe,pe,re,ie,st,W={},De=[],rt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ae=Array.isArray;function M(e,t){for(var o in t)e[o]=t[o];return e}function ce(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function it(e,t,o){var n,l,a,i={};for(a in t)a=="key"?n=t[a]:a=="ref"?l=t[a]:i[a]=t[a];if(arguments.length>2&&(i.children=arguments.length>3?oe.call(arguments,2):o),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)i[a]===void 0&&(i[a]=e.defaultProps[a]);return G(e,i,n,l,null)}function G(e,t,o,n,l){var a={type:e,props:t,key:o,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:l??++Xe,__i:-1,__u:0};return l==null&&y.vnode!=null&&y.vnode(a),a}function F(e){return e.children}function K(e,t){this.props=e,this.context=t}function U(e,t){if(t==null)return e.__?U(e.__,e.__i+1):null;for(var o;t<e.__k.length;t++)if((o=e.__k[t])!=null&&o.__e!=null)return o.__e;return typeof e.type=="function"?U(e):null}function Ue(e){var t,o;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((o=e.__k[t])!=null&&o.__e!=null){e.__e=e.__c.base=o.__e;break}return Ue(e)}}function ge(e){(!e.__d&&(e.__d=!0)&&I.push(e)&&!Z.__r++||me!=y.debounceRendering)&&((me=y.debounceRendering)||Ye)(Z)}function Z(){for(var e,t,o,n,l,a,i,r=1;I.length;)I.length>r&&I.sort(Ie),e=I.shift(),r=I.length,e.__d&&(o=void 0,l=(n=(t=e).__v).__e,a=[],i=[],t.__P&&((o=M({},n)).__v=n.__v+1,y.vnode&&y.vnode(o),_e(t.__P,o,n,t.__n,t.__P.namespaceURI,32&n.__u?[l]:null,a,l??U(n),!!(32&n.__u),i),o.__v=n.__v,o.__.__k[o.__i]=o,Be(a,o,i),o.__e!=l&&Ue(o)));Z.__r=0}function Re(e,t,o,n,l,a,i,r,p,u,c){var s,_,d,b,v,g,f=n&&n.__k||De,m=t.length;for(p=ut(o,t,f,p,m),s=0;s<m;s++)(d=o.__k[s])!=null&&(_=d.__i==-1?W:f[d.__i]||W,d.__i=s,g=_e(e,d,_,l,a,i,r,p,u,c),b=d.__e,d.ref&&_.ref!=d.ref&&(_.ref&&de(_.ref,null,d),c.push(d.ref,d.__c||b,d)),v==null&&b!=null&&(v=b),4&d.__u||_.__k===d.__k?p=$e(d,p,e):typeof d.type=="function"&&g!==void 0?p=g:b&&(p=b.nextSibling),d.__u&=-7);return o.__e=v,p}function ut(e,t,o,n,l){var a,i,r,p,u,c=o.length,s=c,_=0;for(e.__k=new Array(l),a=0;a<l;a++)(i=t[a])!=null&&typeof i!="boolean"&&typeof i!="function"?(p=a+_,(i=e.__k[a]=typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?G(null,i,null,null,null):ae(i)?G(F,{children:i},null,null,null):i.constructor==null&&i.__b>0?G(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=e,i.__b=e.__b+1,r=null,(u=i.__i=pt(i,o,p,s))!=-1&&(s--,(r=o[u])&&(r.__u|=2)),r==null||r.__v==null?(u==-1&&(l>c?_--:l<c&&_++),typeof i.type!="function"&&(i.__u|=4)):u!=p&&(u==p-1?_--:u==p+1?_++:(u>p?_--:_++,i.__u|=4))):e.__k[a]=null;if(s)for(a=0;a<c;a++)(r=o[a])!=null&&(2&r.__u)==0&&(r.__e==n&&(n=U(r)),Ve(r,r));return n}function $e(e,t,o){var n,l;if(typeof e.type=="function"){for(n=e.__k,l=0;n&&l<n.length;l++)n[l]&&(n[l].__=e,t=$e(n[l],t,o));return t}e.__e!=t&&(t&&e.type&&!o.contains(t)&&(t=U(e)),o.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function pt(e,t,o,n){var l,a,i=e.key,r=e.type,p=t[o];if(p===null&&e.key==null||p&&i==p.key&&r==p.type&&(2&p.__u)==0)return o;if(n>(p!=null&&(2&p.__u)==0?1:0))for(l=o-1,a=o+1;l>=0||a<t.length;){if(l>=0){if((p=t[l])&&(2&p.__u)==0&&i==p.key&&r==p.type)return l;l--}if(a<t.length){if((p=t[a])&&(2&p.__u)==0&&i==p.key&&r==p.type)return a;a++}}return-1}function be(e,t,o){t[0]=="-"?e.setProperty(t,o??""):e[t]=o==null?"":typeof o!="number"||rt.test(t)?o:o+"px"}function J(e,t,o,n,l){var a,i;e:if(t=="style")if(typeof o=="string")e.style.cssText=o;else{if(typeof n=="string"&&(e.style.cssText=n=""),n)for(t in n)o&&t in o||be(e.style,t,"");if(o)for(t in o)n&&o[t]==n[t]||be(e.style,t,o[t])}else if(t[0]=="o"&&t[1]=="n")a=t!=(t=t.replace(Fe,"$1")),i=t.toLowerCase(),t=i in e||t=="onFocusOut"||t=="onFocusIn"?i.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=o,o?n?o.u=n.u:(o.u=pe,e.addEventListener(t,a?ie:re,a)):e.removeEventListener(t,a?ie:re,a);else{if(l=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=o??"";break e}catch{}typeof o=="function"||(o==null||o===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&o==1?"":o))}}function ye(e){return function(t){if(this.l){var o=this.l[t.type+e];if(t.t==null)t.t=pe++;else if(t.t<o.u)return;return o(y.event?y.event(t):t)}}}function _e(e,t,o,n,l,a,i,r,p,u){var c,s,_,d,b,v,g,f,m,k,N,S,P,z,X,A,V,E=t.type;if(t.constructor!=null)return null;128&o.__u&&(p=!!(32&o.__u),a=[r=t.__e=o.__e]),(c=y.__b)&&c(t);e:if(typeof E=="function")try{if(f=t.props,m="prototype"in E&&E.prototype.render,k=(c=E.contextType)&&n[c.__c],N=c?k?k.props.value:c.__:n,o.__c?g=(s=t.__c=o.__c).__=s.__E:(m?t.__c=s=new E(f,N):(t.__c=s=new K(f,N),s.constructor=E,s.render=_t),k&&k.sub(s),s.props=f,s.state||(s.state={}),s.context=N,s.__n=n,_=s.__d=!0,s.__h=[],s._sb=[]),m&&s.__s==null&&(s.__s=s.state),m&&E.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=M({},s.__s)),M(s.__s,E.getDerivedStateFromProps(f,s.__s))),d=s.props,b=s.state,s.__v=t,_)m&&E.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),m&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(m&&E.getDerivedStateFromProps==null&&f!==d&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(f,N),!s.__e&&s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(f,s.__s,N)===!1||t.__v==o.__v){for(t.__v!=o.__v&&(s.props=f,s.state=s.__s,s.__d=!1),t.__e=o.__e,t.__k=o.__k,t.__k.some(function(Y){Y&&(Y.__=t)}),S=0;S<s._sb.length;S++)s.__h.push(s._sb[S]);s._sb=[],s.__h.length&&i.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(f,s.__s,N),m&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(d,b,v)})}if(s.context=N,s.props=f,s.__P=e,s.__e=!1,P=y.__r,z=0,m){for(s.state=s.__s,s.__d=!1,P&&P(t),c=s.render(s.props,s.state,s.context),X=0;X<s._sb.length;X++)s.__h.push(s._sb[X]);s._sb=[]}else do s.__d=!1,P&&P(t),c=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++z<25);s.state=s.__s,s.getChildContext!=null&&(n=M(M({},n),s.getChildContext())),m&&!_&&s.getSnapshotBeforeUpdate!=null&&(v=s.getSnapshotBeforeUpdate(d,b)),A=c,c!=null&&c.type===F&&c.key==null&&(A=je(c.props.children)),r=Re(e,ae(A)?A:[A],t,o,n,l,a,i,r,p,u),s.base=t.__e,t.__u&=-161,s.__h.length&&i.push(s),g&&(s.__E=s.__=null)}catch(Y){if(t.__v=null,p||a!=null)if(Y.then){for(t.__u|=p?160:128;r&&r.nodeType==8&&r.nextSibling;)r=r.nextSibling;a[a.indexOf(r)]=null,t.__e=r}else for(V=a.length;V--;)ce(a[V]);else t.__e=o.__e,t.__k=o.__k;y.__e(Y,t,o)}else a==null&&t.__v==o.__v?(t.__k=o.__k,t.__e=o.__e):r=t.__e=ct(o.__e,t,o,n,l,a,i,p,u);return(c=y.diffed)&&c(t),128&t.__u?void 0:r}function Be(e,t,o){for(var n=0;n<o.length;n++)de(o[n],o[++n],o[++n]);y.__c&&y.__c(t,e),e.some(function(l){try{e=l.__h,l.__h=[],e.some(function(a){a.call(l)})}catch(a){y.__e(a,l.__v)}})}function je(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:ae(e)?e.map(je):M({},e)}function ct(e,t,o,n,l,a,i,r,p){var u,c,s,_,d,b,v,g=o.props,f=t.props,m=t.type;if(m=="svg"?l="http://www.w3.org/2000/svg":m=="math"?l="http://www.w3.org/1998/Math/MathML":l||(l="http://www.w3.org/1999/xhtml"),a!=null){for(u=0;u<a.length;u++)if((d=a[u])&&"setAttribute"in d==!!m&&(m?d.localName==m:d.nodeType==3)){e=d,a[u]=null;break}}if(e==null){if(m==null)return document.createTextNode(f);e=document.createElementNS(l,m,f.is&&f),r&&(y.__m&&y.__m(t,a),r=!1),a=null}if(m==null)g===f||r&&e.data==f||(e.data=f);else{if(a=a&&oe.call(e.childNodes),g=o.props||W,!r&&a!=null)for(g={},u=0;u<e.attributes.length;u++)g[(d=e.attributes[u]).name]=d.value;for(u in g)if(d=g[u],u!="children"){if(u=="dangerouslySetInnerHTML")s=d;else if(!(u in f)){if(u=="value"&&"defaultValue"in f||u=="checked"&&"defaultChecked"in f)continue;J(e,u,null,d,l)}}for(u in f)d=f[u],u=="children"?_=d:u=="dangerouslySetInnerHTML"?c=d:u=="value"?b=d:u=="checked"?v=d:r&&typeof d!="function"||g[u]===d||J(e,u,d,g[u],l);if(c)r||s&&(c.__html==s.__html||c.__html==e.innerHTML)||(e.innerHTML=c.__html),t.__k=[];else if(s&&(e.innerHTML=""),Re(t.type=="template"?e.content:e,ae(_)?_:[_],t,o,n,m=="foreignObject"?"http://www.w3.org/1999/xhtml":l,a,i,a?a[0]:o.__k&&U(o,0),r,p),a!=null)for(u=a.length;u--;)ce(a[u]);r||(u="value",m=="progress"&&b==null?e.removeAttribute("value"):b!=null&&(b!==e[u]||m=="progress"&&!b||m=="option"&&b!=g[u])&&J(e,u,b,g[u],l),u="checked",v!=null&&v!=e[u]&&J(e,u,v,g[u],l))}return e}function de(e,t,o){try{if(typeof e=="function"){var n=typeof e.__u=="function";n&&e.__u(),n&&t==null||(e.__u=e(t))}else e.current=t}catch(l){y.__e(l,o)}}function Ve(e,t,o){var n,l;if(y.unmount&&y.unmount(e),(n=e.ref)&&(n.current&&n.current!=e.__e||de(n,null,t)),(n=e.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(a){y.__e(a,t)}n.base=n.__P=null}if(n=e.__k)for(l=0;l<n.length;l++)n[l]&&Ve(n[l],t,o||typeof e.type!="function");o||ce(e.__e),e.__c=e.__=e.__e=void 0}function _t(e,t,o){return this.constructor(e,o)}function xe(e,t,o){var n,l,a,i;t==document&&(t=document.documentElement),y.__&&y.__(e,t),l=(n=typeof o=="function")?null:o&&o.__k||t.__k,a=[],i=[],_e(t,e=(!n&&o||t).__k=it(F,null,[e]),l||W,W,t.namespaceURI,!n&&o?[o]:l?null:t.firstChild?oe.call(t.childNodes):null,a,!n&&o?o:l?l.__e:t.firstChild,n,i),Be(a,e,i)}oe=De.slice,y={__e:function(e,t,o,n){for(var l,a,i;t=t.__;)if((l=t.__c)&&!l.__)try{if((a=l.constructor)&&a.getDerivedStateFromError!=null&&(l.setState(a.getDerivedStateFromError(e)),i=l.__d),l.componentDidCatch!=null&&(l.componentDidCatch(e,n||{}),i=l.__d),i)return l.__E=l}catch(r){e=r}throw e}},Xe=0,lt=function(e){return e!=null&&e.constructor==null},K.prototype.setState=function(e,t){var o;o=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=M({},this.state),typeof e=="function"&&(e=e(M({},o),this.props)),e&&M(o,e),e!=null&&this.__v&&(t&&this._sb.push(t),ge(this))},K.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ge(this))},K.prototype.render=F,I=[],Ye=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ie=function(e,t){return e.__v.__b-t.__v.__b},Z.__r=0,Fe=/(PointerCapture)$|Capture$/i,pe=0,re=ye(!1),ie=ye(!0),st=0;var dt=0,$t=Array.isArray;function h(e,t,o,n,l,a){t||(t={});var i,r,p=t;if("ref"in p)for(r in p={},t)r=="ref"?i=t[r]:p[r]=t[r];var u={type:e,props:p,key:o,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--dt,__i:-1,__u:0,__source:l,__self:a};if(typeof e=="function"&&(i=e.defaultProps))for(r in i)p[r]===void 0&&(p[r]=i[r]);return y.vnode&&y.vnode(u),u}var ht=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id];return h("button",{type:"button",onClick:()=>o({[n.id]:{value:!0}},{event:!0}),children:n.text??n.id})};C("button",ht,{label:null});var q,x,se,we,ee=0,We=[],w=y,ke=w.__b,Ne=w.__r,Se=w.diffed,Ee=w.__c,Ce=w.unmount,Te=w.__;function he(e,t){w.__h&&w.__h(x,e,ee||t),ee=0;var o=x.__H||(x.__H={__:[],__h:[]});return e>=o.__.length&&o.__.push({}),o.__[e]}function L(e){return ee=1,ft(Oe,e)}function ft(e,t,o){var n=he(q++,2);if(n.t=e,!n.__c&&(n.__=[o?o(t):Oe(void 0,t),function(r){var p=n.__N?n.__N[0]:n.__[0],u=n.t(p,r);p!==u&&(n.__N=[u,n.__[1]],n.__c.setState({}))}],n.__c=x,!x.__f)){var l=function(r,p,u){if(!n.__c.__H)return!0;var c=n.__c.__H.__.filter(function(_){return!!_.__c});if(c.every(function(_){return!_.__N}))return!a||a.call(this,r,p,u);var s=n.__c.props!==r;return c.forEach(function(_){if(_.__N){var d=_.__[0];_.__=_.__N,_.__N=void 0,d!==_.__[0]&&(s=!0)}}),a&&a.call(this,r,p,u)||s};x.__f=!0;var a=x.shouldComponentUpdate,i=x.componentWillUpdate;x.componentWillUpdate=function(r,p,u){if(this.__e){var c=a;a=void 0,l(r,p,u),a=c}i&&i.call(this,r,p,u)},x.shouldComponentUpdate=l}return n.__N||n.__}function R(e,t){var o=he(q++,3);!w.__s&&qe(o.__H,t)&&(o.__=e,o.u=t,x.__H.__h.push(o))}function vt(e){return ee=5,mt(function(){return{current:e}},[])}function mt(e,t){var o=he(q++,7);return qe(o.__H,t)&&(o.__=e(),o.__H=t,o.__h=e),o.__}function gt(){for(var e;e=We.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Q),e.__H.__h.forEach(ue),e.__H.__h=[]}catch(t){e.__H.__h=[],w.__e(t,e.__v)}}w.__b=function(e){x=null,ke&&ke(e)},w.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Te&&Te(e,t)},w.__r=function(e){Ne&&Ne(e),q=0;var t=(x=e.__c).__H;t&&(se===x?(t.__h=[],x.__h=[],t.__.forEach(function(o){o.__N&&(o.__=o.__N),o.u=o.__N=void 0})):(t.__h.forEach(Q),t.__h.forEach(ue),t.__h=[],q=0)),se=x},w.diffed=function(e){Se&&Se(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(We.push(t)!==1&&we===w.requestAnimationFrame||((we=w.requestAnimationFrame)||bt)(gt)),t.__H.__.forEach(function(o){o.u&&(o.__H=o.u),o.u=void 0})),se=x=null},w.__c=function(e,t){t.some(function(o){try{o.__h.forEach(Q),o.__h=o.__h.filter(function(n){return!n.__||ue(n)})}catch(n){t.some(function(l){l.__h&&(l.__h=[])}),t=[],w.__e(n,o.__v)}}),Ee&&Ee(e,t)},w.unmount=function(e){Ce&&Ce(e);var t,o=e.__c;o&&o.__H&&(o.__H.__.forEach(function(n){try{Q(n)}catch(l){t=l}}),o.__H=void 0,t&&w.__e(t,o.__v))};var Pe=typeof requestAnimationFrame=="function";function bt(e){var t,o=function(){clearTimeout(n),Pe&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(o,35);Pe&&(t=requestAnimationFrame(o))}function Q(e){var t=x,o=e.__c;typeof o=="function"&&(e.__c=void 0,o()),x=t}function ue(e){var t=x;e.__c=e.__(),x=t}function qe(e,t){return!e||e.length!==t.length||t.some(function(o,n){return o!==e[n]})}function Oe(e,t){return typeof t=="function"?t(e):t}var Ae=e=>e.trim()==="",Me=e=>isFinite(e),yt=(e,t)=>String(e)!==t,xt=(e,t,o)=>e>=t&&e<=o,wt=(e,t,o)=>Math.min(Math.max(e,t),o),te=({value:e,min:t=-1/0,max:o=1/0,commit:n})=>{let[l,a]=L(String(e)),[i,r]=L(e);R(()=>{a(String(e)),r(e)},[e]);function p(c){let s=String(c);if(a(s),Ae(s))return;let _=Number(s);!Me(_)||!xt(_,t,o)||yt(_,s)||(r(_),n(_))}function u(){if(Ae(l)||!Me(Number(l))){a(String(i));return}let c=Number(l),s=wt(c,t,o);a(String(s)),r(s),n(s)}return{value:e,text:l,setValue:p,handleBlur:u}},le=e=>Array.isArray(e)&&e.every(t=>t!=null&&typeof t=="object"&&!Array.isArray(t)&&"label"in t&&"value"in t)?e:Array.isArray(e)?e.map(t=>({label:String(t),value:t})):e&&typeof e=="object"?Object.entries(e).map(([t,o])=>({label:t,value:o})):[],kt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],l=le(n.options).map(({label:a,value:i},r)=>{let p=n.value===i?"soso-selected":"";return h("button",{onClick:()=>o({[n.id]:{value:i}}),className:`${p}`,type:"button",children:a},a)});return h("div",{className:"soso-buttons",children:l})};C("buttons",kt,{value:e=>le(e.options)[0]?.value});var Nt=e=>"#ffffff",St=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],[l,a]=L(n.value),[i,r]=L(n.value);R(()=>{a(n.value)},[n.value]);let p=s=>s.startsWith("#")&&s.length===7&&CSS.supports("color",s),u=s=>{let _=s.currentTarget.value,d=p(_)?_:i;o({[n.id]:{value:d}}),a(d)},c=s=>{let _=s.currentTarget.value;p(_)&&(o({[n.id]:{value:_}}),r(_))};return h(F,{children:[h("input",{type:"color",value:l,onInput:c,className:"soso-color-picker"}),h("input",{type:"text",className:"soso-fixed",size:"7",value:l,onInput:c,onChange:u})]})};C("color",St,{value:Nt});var Et=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id];switch(n.format){case"monospace":return h("span",{className:"soso-display soso-monospace",children:n.value});case"block":return h("pre",{className:"soso-display soso-monospace",children:n.value});case"html":return h("span",{className:"soso-display",dangerouslySetInnerHTML:{__html:n.value??""}});default:return h("span",{className:"soso-display",children:n.value})}};C("display",Et,{value:"",format:"text"});var Ct=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],l=vt(null),[a,i]=L(Array(n.samples).fill(0)),[r,p]=L({min:null,max:null});return R(()=>{i(u=>[...u,n.value].slice(-n.samples)),p(u=>({min:u.min===null?n.value:Math.min(u.min,n.value),max:u.max===null?n.value:Math.max(u.max,n.value)}))},[n]),R(()=>{let u=l.current;if(!u)return;let c=u.getContext("2d"),s=u.getBoundingClientRect(),_=window.devicePixelRatio||1,d=s.width,b=n.height;u.width=d*_,u.height=b*_,c.scale(_,_),u.style.width=d+"px",u.style.height=b+"px",c.clearRect(0,0,d,b);let v=u.closest(".soso-panel"),g=getComputedStyle(v).getPropertyValue("--panel-fg").trim()||"#aaa",f=n.min??r.min??0,m=n.max??r.max??1,k=m-f||1,N=1/(n.samples-1)*d;c.fillStyle=g,c.globalAlpha=.5,c.beginPath(),c.moveTo(0,b),a.forEach((S,P)=>{let z=(S-f)/k*b,X=P*N,A=b-z;c.lineTo(X,A)}),c.lineTo(d,b),c.fill(),c.globalAlpha=1,c.font="10px ui-monospace, monospace",c.textBaseline="top",c.textAlign="left",c.fillText(m,3,0),c.textBaseline="bottom",c.fillText(f,3,b)},[a,r,n]),h("canvas",{className:"soso-graph",ref:l,height:n.height})};C("graph",Ct,{height:60,samples:60});var Je=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id];if(!n.visible)return null;let l=at(n);if(!l)return null;let a=h(l,{nodes:e,treeNode:t,update:o});if(n.layout==="block")return a;let i=!(n.label===""||n.label===null);return h("div",{className:"soso-row",role:"group","aria-label":n.label??n.id,children:[i&&h("span",{className:"soso-label",children:n.label??n.id}),h("div",{className:"soso-control",children:a})]})},Tt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],l=t.nodes.map((p,u)=>h(Je,{nodes:e,treeNode:p,update:o},p.id)),a=n.expanded?"soso-expanded":"soso-collapsed",i=n.showLabel?"soso-show-label":"soso-hide-label",r=!(n.label===""||n.label===null);return h("div",{className:`soso-group ${a} ${i}`,children:[r&&h("span",{className:"soso-label",onClick:()=>{n.expandable&&o({[n.id]:{expanded:!n.expanded}})},children:[n.expandable&&h("span",{className:"soso-icon",children:"\u2303"}),n.label??n.id]}),h("div",{className:"soso-container",children:l})]})};C("group",Tt,{layout:"block",expandable:!0,expanded:!0});var Pt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],{text:l,setValue:a,handleBlur:i}=te({value:n.value,min:n.min,max:n.max,commit:r=>o({[n.id]:{value:r}})});return h("input",{className:"soso-number-input",type:"text",value:l,onInput:r=>a(r.currentTarget.value),onChange:i})};C("number",Pt,{value:()=>0});var Le=(e,t)=>{let o=1/t;return Math.round(e*o)/o},At=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],{x:l,y:a}=n.value,[i,r]=L(!1),[p,u]=L(null),[c,s]=L({height:176,width:176,space:6,radius:2});R(()=>{let v=document.querySelector(".soso-panel");if(!v)return;let g=getComputedStyle(v),f=g.getPropertyValue("--panel-width"),m=g.getPropertyValue("--label-width"),k=g.getPropertyValue("--panel-radius"),N=g.getPropertyValue("--panel-space"),S=parseFloat(f)-parseFloat(m)-2*parseFloat(N),P=parseFloat(k),z=parseFloat(N);s({width:S,height:S,radius:P,space:z})},[]);let _=te({value:n.value.x,min:n.minX,max:n.maxX,commit:v=>o({[n.id]:{value:{...n.value,x:v}}})}),d=te({value:n.value.y,min:n.minY,max:n.maxY,commit:v=>o({[n.id]:{value:{...n.value,y:v}}})});R(()=>{if(!i||!p)return;let v=document.body.style.cursor;document.body.style.cursor="grabbing";let g=k=>{let N=k.clientX??k.touches?.[0]?.clientX,S=k.clientY??k.touches?.[0]?.clientY;if(N===void 0||S===void 0)return;let P=N-p.pointerX,z=S-p.pointerY,X=p.valueX+P*n.scale,A=p.valueY+z*n.scale,V=Math.max(n.minX,Math.min(n.maxX,X)),E=Math.max(n.minY,Math.min(n.maxY,A)),Y=Le(V,n.step),tt=Le(E,n.step);o({[n.id]:{value:{x:Y,y:tt}}})},f=()=>{r(!1),u(null)},m=k=>(k.preventDefault(),!1);return document.addEventListener("mousemove",g),document.addEventListener("mouseup",f),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",f),()=>{document.body.style.cursor=v,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",f)}},[i,p,n]);let b=(v,g=null)=>{let f=v.clientX??v.touches?.[0]?.clientX,m=v.clientY??v.touches?.[0]?.clientY;r(!0),u({pointerX:f,pointerY:m,valueX:g?.x??n.value.x,valueY:g?.y??n.value.y})};return h(F,{children:[h("button",{onMouseDown:v=>{v.preventDefault(),b(v)},onTouchStart:v=>{v.preventDefault(),b(v)},className:`soso-translate ${i?"soso-selected":""}`,type:"button",style:{touchAction:"none",userSelect:"none"},children:"\u2316"}),h("input",{className:"soso-number-input soso-fixed",type:"text",size:"7",value:_.text,onInput:v=>_.setValue(v.currentTarget.value),onChange:_.handleBlur}),h("input",{className:"soso-number-input soso-fixed",type:"text",size:"7",value:d.text,onInput:v=>d.setValue(v.currentTarget.value),onChange:d.handleBlur}),i&&h("div",{className:"soso-pad2",children:h("svg",{width:c.width,height:c.height,style:{position:"absolute",top:0,left:0,borderRadius:c.radius},children:[h("rect",{width:c.width,height:c.height,fill:"transparent",className:"soso-border",rx:c.radius}),h("line",{x1:c.width/2,y1:0,x2:c.width/2,y2:c.height,className:"soso-grid"}),h("line",{x1:0,y1:c.height/2,x2:c.width,y2:c.height/2,className:"soso-grid"}),h("text",{x:c.space,y:c.space,className:"soso-label","dominant-baseline":"hanging","font-size":"10",children:[n.minX,",",n.minY]}),h("text",{x:c.width-c.space,y:c.space,"dominant-baseline":"hanging",className:"soso-label","font-size":"10","text-anchor":"end",children:[n.maxX,",",n.minY]}),h("text",{x:c.space,y:c.height-c.space,className:"soso-label","font-size":"10",children:[n.minX,",",n.maxY]}),h("text",{x:c.width-c.space,y:c.height-c.space,className:"soso-label","font-size":"10","text-anchor":"end",children:[n.maxX,",",n.maxY]}),h("circle",{cx:(l-n.minX)/(n.maxX-n.minX)*c.width,cy:(a-n.minY)/(n.maxY-n.minY)*c.height,r:6,className:"soso-indicator"})]})})]})};C("pad2",At,{value:e=>({x:e.minX+(e.maxX-e.minX)*.5,y:e.minY+(e.maxY-e.minY)*.5}),scale:.01,step:.01,minX:-1,maxX:1,minY:-1,maxY:1});var Mt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],{text:l,setValue:a,handleBlur:i}=te({value:n.value,min:n.min,max:n.max,commit:r=>o({[n.id]:{value:r}})});return h(F,{children:[h("input",{type:"range",value:l,min:n.min,max:n.max,step:n.step??1,onInput:r=>a(r.currentTarget.value)}),h("input",{type:"text",size:"7",className:"soso-number-input soso-fixed",value:l,onInput:r=>a(r.currentTarget.value),onChange:i})]})};C("range",Mt,{value:e=>e.min??0});var Lt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],l=le(n.options),a=p=>{let u=Number(p.currentTarget.value),c=l[u].value;o({[n.id]:{value:c}})},i=l.map(({label:p},u)=>h("option",{value:u,children:p},p)),r=l.findIndex(({value:p})=>p===n.value);return h("select",{value:r<0?"":r,onChange:a,children:i})};C("select",Lt,{value:e=>le(e.options)[0]?.value});var Ht=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],l=a=>{o({[n.id]:{value:a.currentTarget.value}})};return n.multiline?h("textarea",{value:n.value,onInput:l,rows:n.rows}):h("input",{type:"text",value:n.value,onInput:l})};C("text",Ht,{value:"",multiline:!1,rows:4});var zt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id];return h("input",{type:"checkbox",checked:n.value,onInput:l=>o({[n.id]:{value:l.currentTarget.checked}})})};C("toggle",zt,{value:e=>!1});var Xt='.soso-panel-container{position:fixed;top:0;right:0}.soso-panel{--panel-bg: hsl(230 7% 10%);--panel-fg: hsl(230 10% 75%);--panel-border: hsl(230 9% 18%);--panel-hover: hsl(230 9% 26%);--panel-pressed: hsl(230 7% 16%);--panel-low-emphasis: hsl(230 4% 55%);--panel-focus: var(--panel-fg);--panel-selection-fg: var(--panel-bg);--panel-selection-bg: var(--panel-fg);--value-number: hsl(220 80% 65%);--value-string: hsl(139 45% 56%);--panel-space: 4px;--panel-radius: 2px;--panel-width: 256px;--label-width: 80px;--row-height: 20px;--font-ui: system-ui, -apple-system, sans-serif;--font-value: ui-monospace, monospace;--font-size-normal: 11px;--line-height-normal: 1.4;--color-link: var(--value-number);--panel-tween-func: cubic-bezier(.25, .8, .5, 1);--panel-tween-duration: .2s;--checkbox-check-width: 3px;--checkbox-check-height: 9px;width:var(--panel-width);color:var(--panel-fg);font-family:var(--font-ui);font-size:var(--font-size-normal);line-height:var(--line-height-normal);box-sizing:border-box;font-variant-numeric:tabular-nums}.soso-panel .soso-row{display:flex;flex-direction:row;gap:var(--panel-space);padding:var(--panel-space) var(--panel-space)}.soso-panel .soso-row+.soso-row{padding-top:calc(var(--panel-space) * .5)}.soso-panel .soso-row:has(+.soso-row){padding-bottom:calc(var(--panel-space) * .5)}.soso-panel .soso-container .soso-container{border-bottom:1px solid var(--panel-border)}.soso-panel .soso-row .soso-label{display:flex;align-self:flex-start;align-items:center;line-height:1.2;min-height:20px;min-width:0;user-select:none;color:var(--panel-low-emphasis);flex:0 0 var(--label-width)}.soso-panel .soso-group{display:flex;flex-direction:column;background:var(--panel-bg);border-radius:var(--panel-radius)}.soso-panel-container>.soso-panel>.soso-group>.soso-label{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.soso-panel .soso-group>.soso-label{display:flex;align-items:center;user-select:none;background:var(--panel-border);border-radius:var(--panel-radius);height:var(--row-height);padding-left:var(--panel-space);gap:var(--panel-space)}.soso-panel .soso-group>.soso-label:has(>.soso-icon){cursor:pointer}.soso-panel .soso-group>.soso-label>.soso-icon{font-weight:700;font-size:10px;cursor:pointer}@media (prefers-reduced-motion: no-preference){.soso-panel .soso-group>.soso-label>.soso-icon{transition:transform var(--panel-tween-duration) var(--panel-tween-func)}}.soso-panel .soso-group.soso-expanded>.soso-label>.soso-icon{transform:rotate(180deg)}.soso-panel .soso-group>.soso-container{flex-direction:column;overflow:hidden;display:none}.soso-panel .soso-group.soso-expanded>.soso-container{display:flex}@supports (interpolate-size: allow-keywords){.soso-panel .soso-group>.soso-container{display:flex;interpolate-size:allow-keywords;height:0;opacity:0}@media (prefers-reduced-motion: no-preference){.soso-panel .soso-group>.soso-container{transition:height var(--panel-tween-duration) var(--panel-tween-func),padding var(--panel-tween-duration) var(--panel-tween-func),opacity var(--panel-tween-duration) var(--panel-tween-func)}}.soso-panel .soso-group.soso-expanded>.soso-container{height:auto;opacity:1}}.soso-panel-container>.soso-panel{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.soso-panel .soso-row .soso-control{flex:1 1 auto;display:flex;justify-content:flex-start;align-items:center;min-height:var(--row-height);gap:var(--panel-space)}.soso-panel button,.soso-panel input,.soso-panel select,.soso-panel textarea{font-size:inherit;font-family:inherit;width:100%;box-sizing:border-box;border:1px solid transparent;padding:0 var(--panel-space);border-radius:var(--panel-radius);background:var(--panel-border);color:var(--panel-fg)}.soso-panel button,.soso-panel select,.soso-panel input[type=text],.soso-panel input[type=range]{min-height:var(--row-height)}.soso-panel input[type=color]{height:var(--row-height)}.soso-panel button,.soso-panel select,.soso-panel input[type=checkbox],.soso-panel input[type=range],.soso-panel input[type=color]{cursor:pointer}.soso-panel input[type=text],.soso-panel textarea{cursor:text}.soso-panel button:focus-visible,.soso-panel select:focus-visible,.soso-panel input:focus-visible,.soso-panel textarea:focus-visible{outline:2px solid var(--panel-focus);outline-offset:0px}.soso-panel button:focus:not(:focus-visible),.soso-panel select:focus:not(:focus-visible),.soso-panel input:focus:not(:focus-visible),.soso-panel textarea:focus:not(:focus-visible){outline:none}.soso-panel button:hover:not(:active):not(.soso-selected),.soso-panel input:hover,.soso-panel select:hover,.soso-panel textarea:hover{background:var(--panel-hover)}.soso-panel button:active,.soso-panel button.soso-selected{background:var(--panel-fg);color:var(--panel-bg);border-radius:var(--panel-radius)}.soso-panel input::selection,.soso-panel textarea::selection{background:var(--panel-selection-bg);color:var(--panel-selection-fg)}.soso-panel textarea{resize:vertical;min-height:calc(var(--row-height) * 2 + var(--panel-space));line-height:var(--line-height-normal);color:var(--value-string);font-family:var(--font-value)}.soso-panel .soso-buttons{display:flex;flex-direction:row;flex:1;gap:var(--panel-space)}.soso-panel .soso-pad2{position:absolute;align-self:flex-start;margin-top:calc(var(--row-height) + var(--panel-space));width:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));height:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));background:var(--panel-bg);z-index:1001}.soso-panel .soso-pad2 .soso-border,.soso-panel .soso-pad2 .soso-grid{stroke:var(--panel-fg);stroke-opacity:.25}.soso-panel .soso-pad2 .soso-label{fill:var(--panel-fg);opacity:.5}.soso-panel .soso-pad2 .soso-indicator{fill:var(--panel-fg)}.soso-panel button.soso-translate{font-weight:bolder}.soso-panel button.soso-translate.soso-selected{cursor:grabbing}.soso-panel input[type=text]{color:var(--value-string);font-family:var(--font-value)}.soso-panel input[type=text].soso-number-input{color:var(--value-number)}.soso-panel input[type=number]::-webkit-inner-spin-button,.soso-panel input[type=number]::-webkit-outer-spin-button{appearance:none;margin:0}.soso-panel input[type=text].soso-fixed{width:60px}.soso-panel .soso-control>.soso-display{line-height:var(--row-height)}.soso-panel .soso-control>.soso-display.soso-monospace{font-family:var(--font-value)}.soso-panel .soso-display a{color:var(--color-link);text-decoration:underline}.soso-panel .soso-display a:hover{text-decoration:none}.soso-panel pre.soso-display{margin:0}.soso-panel input[type=checkbox]{margin:0;appearance:none;border-radius:var(--panel-radius);width:14px;height:14px;text-align:center}.soso-panel input[type=checkbox]:checked:before{content:"";display:flex;height:var(--checkbox-check-height);width:var(--checkbox-check-width);border-bottom:2px solid var(--panel-fg);border-right:2px solid var(--panel-fg);transform:rotate(45deg)}.soso-panel input[type=range]{-webkit-appearance:none;appearance:none;background:transparent;margin:0;padding:0}.soso-panel input[type=range]::-webkit-slider-runnable-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.soso-panel input[type=range]::-moz-range-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.soso-panel input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);margin-top:-4px}.soso-panel input[type=range]::-moz-range-thumb{width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);border:none}.soso-panel input[type=color]{-webkit-appearance:none;border:1px solid var(--panel-border);padding:0;border-radius:var(--panel-radius);height:var(--row-height)}.soso-panel input[type=color]::-webkit-color-swatch-wrapper{padding:0}.soso-panel input[type=color]::-webkit-color-swatch{border:0}.soso-panel canvas.soso-graph{width:100%}',Yt=0,It=e=>`node ${Yt++}`,Ge=e=>{let{id:t=It(),nodes:o=[],...n}=e,l={},a={id:t,nodes:[]},i={id:t},r=ot(e);for(let p in r)typeof r[p]=="function"?i[p]=r[p]({...r,...e}):i[p]=r[p];return Object.assign(i,n),l[t]=i,o.length>0&&o.forEach(p=>{let[u,c]=Ge(p);Object.assign(l,u),a.nodes.push(c)}),[l,a]},Ft=()=>{let e=document.createElement("div");return e.classList.add("soso-panel-container"),document.body.append(e),e},Dt=()=>{if(!document.querySelector("style[data-soso-panel]")){let e=document.createElement("style");e.textContent=Xt,e.setAttribute("data-soso-panel","true"),document.head.appendChild(e)}},He=Symbol("all"),Ut=class{constructor(e,t){let[o,n]=Ge(e);this.nodes=o,this.root=n,this.container=t.mount??Ft(),this.options=t,this.subscribers=new Map,this.raf=null,t.injectStyles&&Dt(),this.render()}render(){let e=()=>{xe(h("div",{className:`soso-panel ${this.options.classNames.join(" ")}`,children:h(Je,{nodes:this.nodes,treeNode:this.root,update:this.handleUpdate.bind(this)})}),this.container)};if(!this.options.throttleRendering){e();return}this.options.throttleRendering&&!this.raf&&(this.raf=requestAnimationFrame(()=>{e(),this.raf=null}))}handleUpdate(e,{silent:t=!1,event:o=!1}={}){if(typeof e!="object"){console.warn("could not set values: invalid values object");return}for(let n in e){let l=this.nodes[n];if(!l)continue;let a=e[n];o||(this.nodes[n]={...l,...a}),"value"in a&&!t&&this.notifySubscribers(n,e[n].value)}this.render()}notifySubscribers(e,t){this.subscribers.get(e)?.forEach(o=>o(t)),this.subscribers.get(He)?.forEach(o=>o(e,t))}subscribe(e,t){let o=typeof e=="string"?e:He,n=typeof t=="function"?t:typeof e=="function"?e:void 0;if(n===void 0){console.warn("could not subscribe: no handler");return}return this.subscribers.has(o)||this.subscribers.set(o,[]),this.subscribers.get(o).push(n),()=>{let l=this.subscribers.get(o),a=l.indexOf(n);a>-1?l.splice(a,1):console.warn("could not unsubscribe: could not find handler")}}set(e,t){let o={};for(let n in e)o[n]={value:e[n]};this.handleUpdate(o,t)}update(e,t){this.handleUpdate(e,{...t,event:!1})}get(){let e={};for(let t in this.nodes){let o=this.nodes[t]?.value;o!==void 0&&(e[t]=o)}return e}destroy(){this.raf&&cancelAnimationFrame(this.raf),xe(null,this.container),this.options.mount||this.container.remove(),this.subscribers.clear(),this.values={}}},Ke={create(e,t={}){let o=Array.isArray(e)?{type:"group",label:"controls",nodes:e}:e,n=new Ut(o,{throttleRendering:!0,injectStyles:!0,classNames:[],...t});return{subscribe:n.subscribe.bind(n),update:n.update.bind(n),set:n.set.bind(n),get:n.get.bind(n),destroy:n.destroy.bind(n)}}};var O=Ke.create({id:"hello, soso-panel",type:"group",nodes:[{id:"text",type:"text",value:"soso"},{id:"fontSize",type:"range",label:"font size",value:200,min:100,max:1e3,step:50},{id:"maxBubbles",type:"range",label:"# bubbles",value:380,min:0,max:1e3,step:40},{id:"bubbleRadius",type:"range",label:"radius",value:10,min:0,max:100},{id:"bubbleLifeVariance",type:"range",label:"life variance",value:5,min:0,max:100},{id:"bubbleColor",type:"color",label:"color",value:"#ff0055"},{id:"wind",type:"pad2",value:{x:0,y:-.05}},{id:"shadowColor",type:"color",label:"shadow color",value:"#debaba"},{id:"shadow",type:"pad2",label:"shadow offset",value:{x:10,y:10},minX:-20,maxX:20,minY:-20,maxY:20,scale:.1},{id:"showEvents",type:"toggle",label:"show events",value:!1},{id:"sampleInterval",type:"range",label:"sample interval",value:3,min:1,max:20},{id:"numSamples",type:"display",label:"# samples",value:0}]}),T=document.createElement("canvas"),j=document.createElement("canvas"),D=T.getContext("2d",{willReadFrequently:!0}),H=j.getContext("2d");document.getElementById("canvas-container").append(j);var B=[],$=[],Qe=()=>{T.width=j.width=window.innerWidth,T.height=j.height=window.innerHeight},Rt=(e,t,o)=>{D.clearRect(0,0,T.width,T.height),D.font=`${t}px sans-serif`,D.fillStyle="black",D.textAlign="center",D.textBaseline="middle",D.fillText(e,T.width/2,T.height/2),B=[];let n=D.getImageData(0,0,T.width,T.height);for(let l=0;l<T.height;l+=o)for(let a=0;a<T.width;a+=o)n.data[(l*T.width+a)*4+3]>0&&B.push({x:a,y:l});O.set({numSamples:B.length},{silent:!0})},Ze=()=>{let{bubbleLifeVariance:e,shadowColor:t,bubbleColor:o,bubbleRadius:n,maxBubbles:l,wind:a,shadow:i}=O.get();for(H.clearRect(0,0,j.width,j.height);$.length<l&&B.length>0;){let r=B[Math.floor(Math.random()*B.length)];$.push({x:r.x,y:r.y,life:0,maxLife:5+Math.random()*e})}$=$.filter(r=>{r.life+=.1,r.x+=a.x*r.life,r.y+=a.y*r.life;let p=r.life/r.maxLife;return r.radius=Math.sin(p*Math.PI)*n,p<1}),H.fillStyle=t,$.forEach(r=>{H.beginPath(),H.arc(r.x+i.x,r.y+i.y,r.radius,0,2*Math.PI),H.fill()}),H.fillStyle=o,$.forEach(r=>{H.beginPath(),H.arc(r.x,r.y,r.radius,0,2*Math.PI),H.fill()}),requestAnimationFrame(Ze)},fe=document.getElementById("events"),et=e=>{let t=document.createElement("div");t.textContent=`${new Date().toLocaleString("en-US",{})} ${e}`,fe.append(t)},ve=()=>{let{text:e,fontSize:t,sampleInterval:o}=O.get();Rt(e,t,o)};Qe();ve();et("use the panel. events will appear here.");window.addEventListener("resize",()=>{Qe(),ve()});O.subscribe((e,t)=>{ve(),et(`${e}: ${JSON.stringify(t)}`)});O.subscribe("showEvents",e=>e?fe.classList.add("show"):fe.classList.remove("show"));Ze();

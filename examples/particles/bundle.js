var ee={},ct={layout:"row",visible:!0},M=(e,t,o={})=>{ee[e]={...ct,...o,component:t}},Fe=e=>e in ee?!0:(console.warn(`control of type "${e}" is requested but not registered`),!1),dt=e=>{if(!Fe(e.type))return;let{component:t,...o}=ee[e.type];return o},_t=e=>{if(!Fe(e.type))return;let{component:t,...o}=ee[e.type];return t},te,y,Re,ht,F,xe,De,Ue,je,de,ue,pe,ft,$={},Be=[],vt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ne=Array.isArray;function L(e,t){for(var o in t)e[o]=t[o];return e}function _e(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function mt(e,t,o){var n,s,a,l={};for(a in t)a=="key"?n=t[a]:a=="ref"?s=t[a]:l[a]=t[a];if(arguments.length>2&&(l.children=arguments.length>3?te.call(arguments,2):o),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)l[a]===void 0&&(l[a]=e.defaultProps[a]);return O(e,l,n,s,null)}function O(e,t,o,n,s){var a={type:e,props:t,key:o,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++Re,__i:-1,__u:0};return s==null&&y.vnode!=null&&y.vnode(a),a}function R(e){return e.children}function G(e,t){this.props=e,this.context=t}function U(e,t){if(t==null)return e.__?U(e.__,e.__i+1):null;for(var o;t<e.__k.length;t++)if((o=e.__k[t])!=null&&o.__e!=null)return o.__e;return typeof e.type=="function"?U(e):null}function $e(e){var t,o;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((o=e.__k[t])!=null&&o.__e!=null){e.__e=e.__c.base=o.__e;break}return $e(e)}}function we(e){(!e.__d&&(e.__d=!0)&&F.push(e)&&!K.__r++||xe!=y.debounceRendering)&&((xe=y.debounceRendering)||De)(K)}function K(){for(var e,t,o,n,s,a,l,i=1;F.length;)F.length>i&&F.sort(Ue),e=F.shift(),i=F.length,e.__d&&(o=void 0,s=(n=(t=e).__v).__e,a=[],l=[],t.__P&&((o=L({},n)).__v=n.__v+1,y.vnode&&y.vnode(o),he(t.__P,o,n,t.__n,t.__P.namespaceURI,32&n.__u?[s]:null,a,s??U(n),!!(32&n.__u),l),o.__v=n.__v,o.__.__k[o.__i]=o,Ve(a,o,l),o.__e!=s&&$e(o)));K.__r=0}function We(e,t,o,n,s,a,l,i,p,u,c){var r,d,_,b,v,g,f=n&&n.__k||Be,m=t.length;for(p=gt(o,t,f,p,m),r=0;r<m;r++)(_=o.__k[r])!=null&&(d=_.__i==-1?$:f[_.__i]||$,_.__i=r,g=he(e,_,d,s,a,l,i,p,u,c),b=_.__e,_.ref&&d.ref!=_.ref&&(d.ref&&fe(d.ref,null,_),c.push(_.ref,_.__c||b,_)),v==null&&b!=null&&(v=b),4&_.__u||d.__k===_.__k?p=qe(_,p,e):typeof _.type=="function"&&g!==void 0?p=g:b&&(p=b.nextSibling),_.__u&=-7);return o.__e=v,p}function gt(e,t,o,n,s){var a,l,i,p,u,c=o.length,r=c,d=0;for(e.__k=new Array(s),a=0;a<s;a++)(l=t[a])!=null&&typeof l!="boolean"&&typeof l!="function"?(p=a+d,(l=e.__k[a]=typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?O(null,l,null,null,null):ne(l)?O(R,{children:l},null,null,null):l.constructor==null&&l.__b>0?O(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):l).__=e,l.__b=e.__b+1,i=null,(u=l.__i=bt(l,o,p,r))!=-1&&(r--,(i=o[u])&&(i.__u|=2)),i==null||i.__v==null?(u==-1&&(s>c?d--:s<c&&d++),typeof l.type!="function"&&(l.__u|=4)):u!=p&&(u==p-1?d--:u==p+1?d++:(u>p?d--:d++,l.__u|=4))):e.__k[a]=null;if(r)for(a=0;a<c;a++)(i=o[a])!=null&&(2&i.__u)==0&&(i.__e==n&&(n=U(i)),Ge(i,i));return n}function qe(e,t,o){var n,s;if(typeof e.type=="function"){for(n=e.__k,s=0;n&&s<n.length;s++)n[s]&&(n[s].__=e,t=qe(n[s],t,o));return t}e.__e!=t&&(t&&e.type&&!o.contains(t)&&(t=U(e)),o.insertBefore(e.__e,t||null),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function bt(e,t,o,n){var s,a,l=e.key,i=e.type,p=t[o];if(p===null&&e.key==null||p&&l==p.key&&i==p.type&&(2&p.__u)==0)return o;if(n>(p!=null&&(2&p.__u)==0?1:0))for(s=o-1,a=o+1;s>=0||a<t.length;){if(s>=0){if((p=t[s])&&(2&p.__u)==0&&l==p.key&&i==p.type)return s;s--}if(a<t.length){if((p=t[a])&&(2&p.__u)==0&&l==p.key&&i==p.type)return a;a++}}return-1}function ke(e,t,o){t[0]=="-"?e.setProperty(t,o??""):e[t]=o==null?"":typeof o!="number"||vt.test(t)?o:o+"px"}function V(e,t,o,n,s){var a,l;e:if(t=="style")if(typeof o=="string")e.style.cssText=o;else{if(typeof n=="string"&&(e.style.cssText=n=""),n)for(t in n)o&&t in o||ke(e.style,t,"");if(o)for(t in o)n&&o[t]==n[t]||ke(e.style,t,o[t])}else if(t[0]=="o"&&t[1]=="n")a=t!=(t=t.replace(je,"$1")),l=t.toLowerCase(),t=l in e||t=="onFocusOut"||t=="onFocusIn"?l.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=o,o?n?o.u=n.u:(o.u=de,e.addEventListener(t,a?pe:ue,a)):e.removeEventListener(t,a?pe:ue,a);else{if(s=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=o??"";break e}catch{}typeof o=="function"||(o==null||o===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&o==1?"":o))}}function Ne(e){return function(t){if(this.l){var o=this.l[t.type+e];if(t.t==null)t.t=de++;else if(t.t<o.u)return;return o(y.event?y.event(t):t)}}}function he(e,t,o,n,s,a,l,i,p,u){var c,r,d,_,b,v,g,f,m,S,E,z,P,Y,H,A,B,C=t.type;if(t.constructor!=null)return null;128&o.__u&&(p=!!(32&o.__u),a=[i=t.__e=o.__e]),(c=y.__b)&&c(t);e:if(typeof C=="function")try{if(f=t.props,m="prototype"in C&&C.prototype.render,S=(c=C.contextType)&&n[c.__c],E=c?S?S.props.value:c.__:n,o.__c?g=(r=t.__c=o.__c).__=r.__E:(m?t.__c=r=new C(f,E):(t.__c=r=new G(f,E),r.constructor=C,r.render=xt),S&&S.sub(r),r.props=f,r.state||(r.state={}),r.context=E,r.__n=n,d=r.__d=!0,r.__h=[],r._sb=[]),m&&r.__s==null&&(r.__s=r.state),m&&C.getDerivedStateFromProps!=null&&(r.__s==r.state&&(r.__s=L({},r.__s)),L(r.__s,C.getDerivedStateFromProps(f,r.__s))),_=r.props,b=r.state,r.__v=t,d)m&&C.getDerivedStateFromProps==null&&r.componentWillMount!=null&&r.componentWillMount(),m&&r.componentDidMount!=null&&r.__h.push(r.componentDidMount);else{if(m&&C.getDerivedStateFromProps==null&&f!==_&&r.componentWillReceiveProps!=null&&r.componentWillReceiveProps(f,E),!r.__e&&r.shouldComponentUpdate!=null&&r.shouldComponentUpdate(f,r.__s,E)===!1||t.__v==o.__v){for(t.__v!=o.__v&&(r.props=f,r.state=r.__s,r.__d=!1),t.__e=o.__e,t.__k=o.__k,t.__k.some(function(I){I&&(I.__=t)}),z=0;z<r._sb.length;z++)r.__h.push(r._sb[z]);r._sb=[],r.__h.length&&l.push(r);break e}r.componentWillUpdate!=null&&r.componentWillUpdate(f,r.__s,E),m&&r.componentDidUpdate!=null&&r.__h.push(function(){r.componentDidUpdate(_,b,v)})}if(r.context=E,r.props=f,r.__P=e,r.__e=!1,P=y.__r,Y=0,m){for(r.state=r.__s,r.__d=!1,P&&P(t),c=r.render(r.props,r.state,r.context),H=0;H<r._sb.length;H++)r.__h.push(r._sb[H]);r._sb=[]}else do r.__d=!1,P&&P(t),c=r.render(r.props,r.state,r.context),r.state=r.__s;while(r.__d&&++Y<25);r.state=r.__s,r.getChildContext!=null&&(n=L(L({},n),r.getChildContext())),m&&!d&&r.getSnapshotBeforeUpdate!=null&&(v=r.getSnapshotBeforeUpdate(_,b)),A=c,c!=null&&c.type===R&&c.key==null&&(A=Oe(c.props.children)),i=We(e,ne(A)?A:[A],t,o,n,s,a,l,i,p,u),r.base=t.__e,t.__u&=-161,r.__h.length&&l.push(r),g&&(r.__E=r.__=null)}catch(I){if(t.__v=null,p||a!=null)if(I.then){for(t.__u|=p?160:128;i&&i.nodeType==8&&i.nextSibling;)i=i.nextSibling;a[a.indexOf(i)]=null,t.__e=i}else for(B=a.length;B--;)_e(a[B]);else t.__e=o.__e,t.__k=o.__k;y.__e(I,t,o)}else a==null&&t.__v==o.__v?(t.__k=o.__k,t.__e=o.__e):i=t.__e=yt(o.__e,t,o,n,s,a,l,p,u);return(c=y.diffed)&&c(t),128&t.__u?void 0:i}function Ve(e,t,o){for(var n=0;n<o.length;n++)fe(o[n],o[++n],o[++n]);y.__c&&y.__c(t,e),e.some(function(s){try{e=s.__h,s.__h=[],e.some(function(a){a.call(s)})}catch(a){y.__e(a,s.__v)}})}function Oe(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:ne(e)?e.map(Oe):L({},e)}function yt(e,t,o,n,s,a,l,i,p){var u,c,r,d,_,b,v,g=o.props,f=t.props,m=t.type;if(m=="svg"?s="http://www.w3.org/2000/svg":m=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),a!=null){for(u=0;u<a.length;u++)if((_=a[u])&&"setAttribute"in _==!!m&&(m?_.localName==m:_.nodeType==3)){e=_,a[u]=null;break}}if(e==null){if(m==null)return document.createTextNode(f);e=document.createElementNS(s,m,f.is&&f),i&&(y.__m&&y.__m(t,a),i=!1),a=null}if(m==null)g===f||i&&e.data==f||(e.data=f);else{if(a=a&&te.call(e.childNodes),g=o.props||$,!i&&a!=null)for(g={},u=0;u<e.attributes.length;u++)g[(_=e.attributes[u]).name]=_.value;for(u in g)if(_=g[u],u!="children"){if(u=="dangerouslySetInnerHTML")r=_;else if(!(u in f)){if(u=="value"&&"defaultValue"in f||u=="checked"&&"defaultChecked"in f)continue;V(e,u,null,_,s)}}for(u in f)_=f[u],u=="children"?d=_:u=="dangerouslySetInnerHTML"?c=_:u=="value"?b=_:u=="checked"?v=_:i&&typeof _!="function"||g[u]===_||V(e,u,_,g[u],s);if(c)i||r&&(c.__html==r.__html||c.__html==e.innerHTML)||(e.innerHTML=c.__html),t.__k=[];else if(r&&(e.innerHTML=""),We(t.type=="template"?e.content:e,ne(d)?d:[d],t,o,n,m=="foreignObject"?"http://www.w3.org/1999/xhtml":s,a,l,a?a[0]:o.__k&&U(o,0),i,p),a!=null)for(u=a.length;u--;)_e(a[u]);i||(u="value",m=="progress"&&b==null?e.removeAttribute("value"):b!=null&&(b!==e[u]||m=="progress"&&!b||m=="option"&&b!=g[u])&&V(e,u,b,g[u],s),u="checked",v!=null&&v!=e[u]&&V(e,u,v,g[u],s))}return e}function fe(e,t,o){try{if(typeof e=="function"){var n=typeof e.__u=="function";n&&e.__u(),n&&t==null||(e.__u=e(t))}else e.current=t}catch(s){y.__e(s,o)}}function Ge(e,t,o){var n,s;if(y.unmount&&y.unmount(e),(n=e.ref)&&(n.current&&n.current!=e.__e||fe(n,null,t)),(n=e.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(a){y.__e(a,t)}n.base=n.__P=null}if(n=e.__k)for(s=0;s<n.length;s++)n[s]&&Ge(n[s],t,o||typeof e.type!="function");o||_e(e.__e),e.__c=e.__=e.__e=void 0}function xt(e,t,o){return this.constructor(e,o)}function Se(e,t,o){var n,s,a,l;t==document&&(t=document.documentElement),y.__&&y.__(e,t),s=(n=typeof o=="function")?null:o&&o.__k||t.__k,a=[],l=[],he(t,e=(!n&&o||t).__k=mt(R,null,[e]),s||$,$,t.namespaceURI,!n&&o?[o]:s?null:t.firstChild?te.call(t.childNodes):null,a,!n&&o?o:s?s.__e:t.firstChild,n,l),Ve(a,e,l)}te=Be.slice,y={__e:function(e,t,o,n){for(var s,a,l;t=t.__;)if((s=t.__c)&&!s.__)try{if((a=s.constructor)&&a.getDerivedStateFromError!=null&&(s.setState(a.getDerivedStateFromError(e)),l=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(e,n||{}),l=s.__d),l)return s.__E=s}catch(i){e=i}throw e}},Re=0,ht=function(e){return e!=null&&e.constructor==null},G.prototype.setState=function(e,t){var o;o=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=L({},this.state),typeof e=="function"&&(e=e(L({},o),this.props)),e&&L(o,e),e!=null&&this.__v&&(t&&this._sb.push(t),we(this))},G.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),we(this))},G.prototype.render=R,F=[],De=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ue=function(e,t){return e.__v.__b-t.__v.__b},K.__r=0,je=/(PointerCapture)$|Capture$/i,de=0,ue=Ne(!1),pe=Ne(!0),ft=0;var wt=0,Zt=Array.isArray;function h(e,t,o,n,s,a){t||(t={});var l,i,p=t;if("ref"in p)for(i in p={},t)i=="ref"?l=t[i]:p[i]=t[i];var u={type:e,props:p,key:o,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--wt,__i:-1,__u:0,__source:s,__self:a};if(typeof e=="function"&&(l=e.defaultProps))for(i in l)p[i]===void 0&&(p[i]=l[i]);return y.vnode&&y.vnode(u),u}var kt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id];return h("button",{type:"button",onClick:()=>o({[n.id]:{value:!0}},{event:!0}),children:n.text??n.id})};M("button",kt,{label:null});var W,x,ie,Ee,Q=0,Je=[],w=y,Te=w.__b,ze=w.__r,Ce=w.diffed,Me=w.__c,Pe=w.unmount,Ae=w.__;function ve(e,t){w.__h&&w.__h(x,e,Q||t),Q=0;var o=x.__H||(x.__H={__:[],__h:[]});return e>=o.__.length&&o.__.push({}),o.__[e]}function X(e){return Q=1,Nt(Qe,e)}function Nt(e,t,o){var n=ve(W++,2);if(n.t=e,!n.__c&&(n.__=[o?o(t):Qe(void 0,t),function(i){var p=n.__N?n.__N[0]:n.__[0],u=n.t(p,i);p!==u&&(n.__N=[u,n.__[1]],n.__c.setState({}))}],n.__c=x,!x.__f)){var s=function(i,p,u){if(!n.__c.__H)return!0;var c=n.__c.__H.__.filter(function(d){return!!d.__c});if(c.every(function(d){return!d.__N}))return!a||a.call(this,i,p,u);var r=n.__c.props!==i;return c.forEach(function(d){if(d.__N){var _=d.__[0];d.__=d.__N,d.__N=void 0,_!==d.__[0]&&(r=!0)}}),a&&a.call(this,i,p,u)||r};x.__f=!0;var a=x.shouldComponentUpdate,l=x.componentWillUpdate;x.componentWillUpdate=function(i,p,u){if(this.__e){var c=a;a=void 0,s(i,p,u),a=c}l&&l.call(this,i,p,u)},x.shouldComponentUpdate=s}return n.__N||n.__}function j(e,t){var o=ve(W++,3);!w.__s&&Ke(o.__H,t)&&(o.__=e,o.u=t,x.__H.__h.push(o))}function St(e){return Q=5,Et(function(){return{current:e}},[])}function Et(e,t){var o=ve(W++,7);return Ke(o.__H,t)&&(o.__=e(),o.__H=t,o.__h=e),o.__}function Tt(){for(var e;e=Je.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(J),e.__H.__h.forEach(ce),e.__H.__h=[]}catch(t){e.__H.__h=[],w.__e(t,e.__v)}}w.__b=function(e){x=null,Te&&Te(e)},w.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Ae&&Ae(e,t)},w.__r=function(e){ze&&ze(e),W=0;var t=(x=e.__c).__H;t&&(ie===x?(t.__h=[],x.__h=[],t.__.forEach(function(o){o.__N&&(o.__=o.__N),o.u=o.__N=void 0})):(t.__h.forEach(J),t.__h.forEach(ce),t.__h=[],W=0)),ie=x},w.diffed=function(e){Ce&&Ce(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Je.push(t)!==1&&Ee===w.requestAnimationFrame||((Ee=w.requestAnimationFrame)||zt)(Tt)),t.__H.__.forEach(function(o){o.u&&(o.__H=o.u),o.u=void 0})),ie=x=null},w.__c=function(e,t){t.some(function(o){try{o.__h.forEach(J),o.__h=o.__h.filter(function(n){return!n.__||ce(n)})}catch(n){t.some(function(s){s.__h&&(s.__h=[])}),t=[],w.__e(n,o.__v)}}),Me&&Me(e,t)},w.unmount=function(e){Pe&&Pe(e);var t,o=e.__c;o&&o.__H&&(o.__H.__.forEach(function(n){try{J(n)}catch(s){t=s}}),o.__H=void 0,t&&w.__e(t,o.__v))};var Le=typeof requestAnimationFrame=="function";function zt(e){var t,o=function(){clearTimeout(n),Le&&cancelAnimationFrame(t),setTimeout(e)},n=setTimeout(o,35);Le&&(t=requestAnimationFrame(o))}function J(e){var t=x,o=e.__c;typeof o=="function"&&(e.__c=void 0,o()),x=t}function ce(e){var t=x;e.__c=e.__(),x=t}function Ke(e,t){return!e||e.length!==t.length||t.some(function(o,n){return o!==e[n]})}function Qe(e,t){return typeof t=="function"?t(e):t}var Xe=e=>e.trim()==="",Ye=e=>isFinite(e),Ct=(e,t)=>String(e)!==t,Mt=(e,t,o)=>e>=t&&e<=o,Pt=(e,t,o)=>Math.min(Math.max(e,t),o),Z=({value:e,min:t=-1/0,max:o=1/0,commit:n})=>{let[s,a]=X(String(e)),[l,i]=X(e);j(()=>{a(String(e)),i(e)},[e]);function p(c){let r=String(c);if(a(r),Xe(r))return;let d=Number(r);!Ye(d)||!Mt(d,t,o)||Ct(d,r)||(i(d),n(d))}function u(){if(Xe(s)||!Ye(Number(s))){a(String(l));return}let c=Number(s),r=Pt(c,t,o);a(String(r)),i(r),n(r)}return{value:e,text:s,setValue:p,handleBlur:u}},oe=e=>Array.isArray(e)&&e.every(t=>t!=null&&typeof t=="object"&&!Array.isArray(t)&&"label"in t&&"value"in t)?e:Array.isArray(e)?e.map(t=>({label:String(t),value:t})):e&&typeof e=="object"?Object.entries(e).map(([t,o])=>({label:t,value:o})):[],At=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],s=oe(n.options).map(({label:a,value:l},i)=>{let p=n.value===l?"soso-selected":"";return h("button",{onClick:()=>o({[n.id]:{value:l}}),className:`${p}`,type:"button",children:a},a)});return h("div",{className:"soso-buttons",children:s})};M("buttons",At,{value:e=>oe(e.options)[0]?.value});var Lt=e=>"#ffffff",Xt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],[s,a]=X(n.value),[l,i]=X(n.value);j(()=>{a(n.value)},[n.value]);let p=r=>r.startsWith("#")&&r.length===7&&CSS.supports("color",r),u=r=>{let d=r.currentTarget.value,_=p(d)?d:l;o({[n.id]:{value:_}}),a(_)},c=r=>{let d=r.currentTarget.value;p(d)&&(o({[n.id]:{value:d}}),i(d))};return h(R,{children:[h("input",{type:"color",value:s,onInput:c,className:"soso-color-picker"}),h("input",{type:"text",className:"soso-fixed",size:"7",value:s,onInput:c,onChange:u})]})};M("color",Xt,{value:Lt});var Yt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id];switch(n.format){case"monospace":return h("span",{className:"soso-display soso-monospace",children:n.value});case"block":return h("pre",{className:"soso-display soso-monospace",children:n.value});case"html":return h("span",{className:"soso-display",dangerouslySetInnerHTML:{__html:n.value??""}});default:return h("span",{className:"soso-display",children:n.value})}};M("display",Yt,{value:"",format:"text"});var Ht=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],s=St(null),[a,l]=X(Array(n.samples).fill(0)),[i,p]=X({min:null,max:null});return j(()=>{l(u=>[...u,n.value].slice(-n.samples)),p(u=>({min:u.min===null?n.value:Math.min(u.min,n.value),max:u.max===null?n.value:Math.max(u.max,n.value)}))},[n]),j(()=>{let u=s.current;if(!u)return;let c=u.getContext("2d"),r=u.getBoundingClientRect(),d=window.devicePixelRatio||1,_=r.width,b=n.height;u.width=_*d,u.height=b*d,c.scale(d,d),u.style.width=_+"px",u.style.height=b+"px",c.clearRect(0,0,_,b);let v=u.closest(".soso-panel"),g=getComputedStyle(v).getPropertyValue("--panel-fg").trim()||"#aaa",f=n.min??i.min??0,m=n.max??i.max??1,S=m-f||1,E=1/(n.samples-1)*_;c.fillStyle=g,c.globalAlpha=.5,c.beginPath(),c.moveTo(0,b),a.forEach((z,P)=>{let Y=(z-f)/S*b,H=P*E,A=b-Y;c.lineTo(H,A)}),c.lineTo(_,b),c.fill(),c.globalAlpha=1,c.font="10px ui-monospace, monospace",c.textBaseline="top",c.textAlign="left",c.fillText(m,3,0),c.textBaseline="bottom",c.fillText(f,3,b)},[a,i,n]),h("canvas",{className:"soso-graph",ref:s,height:n.height})};M("graph",Ht,{height:60,samples:60});var Ze=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id];if(!n.visible)return null;let s=_t(n);if(!s)return null;let a=h(s,{nodes:e,treeNode:t,update:o});if(n.layout==="block")return a;let l=!(n.label===""||n.label===null);return h("div",{className:"soso-row",role:"group","aria-label":n.label??n.id,children:[l&&h("span",{className:"soso-label",children:n.label??n.id}),h("div",{className:"soso-control",children:a})]})},It=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],s=t.nodes.map((p,u)=>h(Ze,{nodes:e,treeNode:p,update:o},p.id)),a=n.expanded?"soso-expanded":"soso-collapsed",l=n.showLabel?"soso-show-label":"soso-hide-label",i=!(n.label===""||n.label===null);return h("div",{className:`soso-group ${a} ${l}`,children:[i&&h("span",{className:"soso-label",onClick:()=>{n.expandable&&o({[n.id]:{expanded:!n.expanded}})},children:[n.expandable&&h("span",{className:"soso-icon",children:"\u2303"}),n.label??n.id]}),h("div",{className:"soso-container",children:s})]})};M("group",It,{layout:"block",expandable:!0,expanded:!0});var Ft=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],{text:s,setValue:a,handleBlur:l}=Z({value:n.value,min:n.min,max:n.max,commit:i=>o({[n.id]:{value:i}})});return h("input",{className:"soso-number-input",type:"text",value:s,onInput:i=>a(i.currentTarget.value),onChange:l})};M("number",Ft,{value:()=>0});var He=(e,t)=>{let o=1/t;return Math.round(e*o)/o},Rt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],{x:s,y:a}=n.value,[l,i]=X(!1),[p,u]=X(null),[c,r]=X({height:176,width:176,space:6,radius:2});j(()=>{let v=document.querySelector(".soso-panel");if(!v)return;let g=getComputedStyle(v),f=g.getPropertyValue("--panel-width"),m=g.getPropertyValue("--label-width"),S=g.getPropertyValue("--panel-radius"),E=g.getPropertyValue("--panel-space"),z=parseFloat(f)-parseFloat(m)-2*parseFloat(E),P=parseFloat(S),Y=parseFloat(E);r({width:z,height:z,radius:P,space:Y})},[]);let d=Z({value:n.value.x,min:n.minX,max:n.maxX,commit:v=>o({[n.id]:{value:{...n.value,x:v}}})}),_=Z({value:n.value.y,min:n.minY,max:n.maxY,commit:v=>o({[n.id]:{value:{...n.value,y:v}}})});j(()=>{if(!l||!p)return;let v=document.body.style.cursor;document.body.style.cursor="grabbing";let g=S=>{let E=S.clientX??S.touches?.[0]?.clientX,z=S.clientY??S.touches?.[0]?.clientY;if(E===void 0||z===void 0)return;let P=E-p.pointerX,Y=z-p.pointerY,H=p.valueX+P*n.scale,A=p.valueY+Y*n.scale,B=Math.max(n.minX,Math.min(n.maxX,H)),C=Math.max(n.minY,Math.min(n.maxY,A)),I=He(B,n.step),pt=He(C,n.step);o({[n.id]:{value:{x:I,y:pt}}})},f=()=>{i(!1),u(null)},m=S=>(S.preventDefault(),!1);return document.addEventListener("mousemove",g),document.addEventListener("mouseup",f),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",f),()=>{document.body.style.cursor=v,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",f)}},[l,p,n]);let b=(v,g=null)=>{let f=v.clientX??v.touches?.[0]?.clientX,m=v.clientY??v.touches?.[0]?.clientY;i(!0),u({pointerX:f,pointerY:m,valueX:g?.x??n.value.x,valueY:g?.y??n.value.y})};return h(R,{children:[h("button",{onMouseDown:v=>{v.preventDefault(),b(v)},onTouchStart:v=>{v.preventDefault(),b(v)},className:`soso-translate ${l?"soso-selected":""}`,type:"button",style:{touchAction:"none",userSelect:"none"},children:"\u2316"}),h("input",{className:"soso-number-input soso-fixed",type:"text",size:"7",value:d.text,onInput:v=>d.setValue(v.currentTarget.value),onChange:d.handleBlur}),h("input",{className:"soso-number-input soso-fixed",type:"text",size:"7",value:_.text,onInput:v=>_.setValue(v.currentTarget.value),onChange:_.handleBlur}),l&&h("div",{className:"soso-pad2",children:h("svg",{width:c.width,height:c.height,style:{position:"absolute",top:0,left:0,borderRadius:c.radius},children:[h("rect",{width:c.width,height:c.height,fill:"transparent",className:"soso-border",rx:c.radius}),h("line",{x1:c.width/2,y1:0,x2:c.width/2,y2:c.height,className:"soso-grid"}),h("line",{x1:0,y1:c.height/2,x2:c.width,y2:c.height/2,className:"soso-grid"}),h("text",{x:c.space,y:c.space,className:"soso-label","dominant-baseline":"hanging","font-size":"10",children:[n.minX,",",n.minY]}),h("text",{x:c.width-c.space,y:c.space,"dominant-baseline":"hanging",className:"soso-label","font-size":"10","text-anchor":"end",children:[n.maxX,",",n.minY]}),h("text",{x:c.space,y:c.height-c.space,className:"soso-label","font-size":"10",children:[n.minX,",",n.maxY]}),h("text",{x:c.width-c.space,y:c.height-c.space,className:"soso-label","font-size":"10","text-anchor":"end",children:[n.maxX,",",n.maxY]}),h("circle",{cx:(s-n.minX)/(n.maxX-n.minX)*c.width,cy:(a-n.minY)/(n.maxY-n.minY)*c.height,r:6,className:"soso-indicator"})]})})]})};M("pad2",Rt,{value:e=>({x:e.minX+(e.maxX-e.minX)*.5,y:e.minY+(e.maxY-e.minY)*.5}),scale:.01,step:.01,minX:-1,maxX:1,minY:-1,maxY:1});var Dt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],{text:s,setValue:a,handleBlur:l}=Z({value:n.value,min:n.min,max:n.max,commit:i=>o({[n.id]:{value:i}})});return h(R,{children:[h("input",{type:"range",value:s,min:n.min,max:n.max,step:n.step??1,onInput:i=>a(i.currentTarget.value)}),h("input",{type:"text",size:"7",className:"soso-number-input soso-fixed",value:s,onInput:i=>a(i.currentTarget.value),onChange:l})]})};M("range",Dt,{value:e=>e.min??0});var Ut=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],s=oe(n.options),a=p=>{let u=Number(p.currentTarget.value),c=s[u].value;o({[n.id]:{value:c}})},l=s.map(({label:p},u)=>h("option",{value:u,children:p},p)),i=s.findIndex(({value:p})=>p===n.value);return h("select",{value:i<0?"":i,onChange:a,children:l})};M("select",Ut,{value:e=>oe(e.options)[0]?.value});var jt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id],s=a=>{o({[n.id]:{value:a.currentTarget.value}})};return n.multiline?h("textarea",{value:n.value,onInput:s,rows:n.rows}):h("input",{type:"text",value:n.value,onInput:s})};M("text",jt,{value:"",multiline:!1,rows:4});var Bt=({nodes:e,treeNode:t,update:o})=>{let n=e[t.id];return h("input",{type:"checkbox",checked:n.value,onInput:s=>o({[n.id]:{value:s.currentTarget.checked}})})};M("toggle",Bt,{value:e=>!1});var $t='.soso-panel-container{position:fixed;top:0;right:0}.soso-panel{--panel-bg: hsl(230 7% 10%);--panel-fg: hsl(230 10% 75%);--panel-border: hsl(230 9% 18%);--panel-hover: hsl(230 9% 26%);--panel-pressed: hsl(230 7% 16%);--panel-low-emphasis: hsl(230 4% 55%);--panel-focus: var(--panel-fg);--panel-selection-fg: var(--panel-bg);--panel-selection-bg: var(--panel-fg);--value-number: hsl(220 80% 65%);--value-string: hsl(139 45% 56%);--panel-space: 4px;--panel-radius: 2px;--panel-width: 256px;--label-width: 80px;--row-height: 20px;--font-ui: system-ui, -apple-system, sans-serif;--font-value: ui-monospace, monospace;--font-size-normal: 11px;--line-height-normal: 1.4;--color-link: var(--value-number);--panel-tween-func: cubic-bezier(.25, .8, .5, 1);--panel-tween-duration: .2s;--checkbox-check-width: 3px;--checkbox-check-height: 9px;width:var(--panel-width);color:var(--panel-fg);font-family:var(--font-ui);font-size:var(--font-size-normal);line-height:var(--line-height-normal);box-sizing:border-box;font-variant-numeric:tabular-nums}.soso-panel .soso-row{display:flex;flex-direction:row;gap:var(--panel-space);padding:var(--panel-space) var(--panel-space)}.soso-panel .soso-row+.soso-row{padding-top:calc(var(--panel-space) * .5)}.soso-panel .soso-row:has(+.soso-row){padding-bottom:calc(var(--panel-space) * .5)}.soso-panel .soso-container .soso-container{border-bottom:1px solid var(--panel-border)}.soso-panel .soso-row .soso-label{display:flex;align-self:flex-start;align-items:center;line-height:1.2;min-height:20px;min-width:0;user-select:none;color:var(--panel-low-emphasis);flex:0 0 var(--label-width)}.soso-panel .soso-group{display:flex;flex-direction:column;background:var(--panel-bg);border-radius:var(--panel-radius)}.soso-panel-container>.soso-panel>.soso-group>.soso-label{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.soso-panel .soso-group>.soso-label{display:flex;align-items:center;user-select:none;background:var(--panel-border);border-radius:var(--panel-radius);height:var(--row-height);padding-left:var(--panel-space);gap:var(--panel-space)}.soso-panel .soso-group>.soso-label:has(>.soso-icon){cursor:pointer}.soso-panel .soso-group>.soso-label>.soso-icon{font-weight:700;font-size:10px;cursor:pointer}@media (prefers-reduced-motion: no-preference){.soso-panel .soso-group>.soso-label>.soso-icon{transition:transform var(--panel-tween-duration) var(--panel-tween-func)}}.soso-panel .soso-group.soso-expanded>.soso-label>.soso-icon{transform:rotate(180deg)}.soso-panel .soso-group>.soso-container{flex-direction:column;overflow:hidden;display:none}.soso-panel .soso-group.soso-expanded>.soso-container{display:flex}@supports (interpolate-size: allow-keywords){.soso-panel .soso-group>.soso-container{display:flex;interpolate-size:allow-keywords;height:0;opacity:0}@media (prefers-reduced-motion: no-preference){.soso-panel .soso-group>.soso-container{transition:height var(--panel-tween-duration) var(--panel-tween-func),padding var(--panel-tween-duration) var(--panel-tween-func),opacity var(--panel-tween-duration) var(--panel-tween-func)}}.soso-panel .soso-group.soso-expanded>.soso-container{height:auto;opacity:1}}.soso-panel-container>.soso-panel{border-radius:0 0 var(--panel-radius) var(--panel-radius)}.soso-panel .soso-row .soso-control{flex:1 1 auto;display:flex;justify-content:flex-start;align-items:center;min-height:var(--row-height);gap:var(--panel-space)}.soso-panel button,.soso-panel input,.soso-panel select,.soso-panel textarea{font-size:inherit;font-family:inherit;width:100%;box-sizing:border-box;border:1px solid transparent;padding:0 var(--panel-space);border-radius:var(--panel-radius);background:var(--panel-border);color:var(--panel-fg)}.soso-panel button,.soso-panel select,.soso-panel input[type=text],.soso-panel input[type=range]{min-height:var(--row-height)}.soso-panel input[type=color]{height:var(--row-height)}.soso-panel button,.soso-panel select,.soso-panel input[type=checkbox],.soso-panel input[type=range],.soso-panel input[type=color]{cursor:pointer}.soso-panel input[type=text],.soso-panel textarea{cursor:text}.soso-panel button:focus-visible,.soso-panel select:focus-visible,.soso-panel input:focus-visible,.soso-panel textarea:focus-visible{outline:2px solid var(--panel-focus);outline-offset:0px}.soso-panel button:focus:not(:focus-visible),.soso-panel select:focus:not(:focus-visible),.soso-panel input:focus:not(:focus-visible),.soso-panel textarea:focus:not(:focus-visible){outline:none}.soso-panel button:hover:not(:active):not(.soso-selected),.soso-panel input:hover,.soso-panel select:hover,.soso-panel textarea:hover{background:var(--panel-hover)}.soso-panel button:active,.soso-panel button.soso-selected{background:var(--panel-fg);color:var(--panel-bg);border-radius:var(--panel-radius)}.soso-panel input::selection,.soso-panel textarea::selection{background:var(--panel-selection-bg);color:var(--panel-selection-fg)}.soso-panel textarea{resize:vertical;min-height:calc(var(--row-height) * 2 + var(--panel-space));line-height:var(--line-height-normal);color:var(--value-string);font-family:var(--font-value)}.soso-panel .soso-buttons{display:flex;flex-direction:row;flex:1;gap:var(--panel-space)}.soso-panel .soso-pad2{position:absolute;align-self:flex-start;margin-top:calc(var(--row-height) + var(--panel-space));width:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));height:calc(var(--panel-width) - var(--label-width) - 2 * var(--panel-space));background:var(--panel-bg);z-index:1001}.soso-panel .soso-pad2 .soso-border,.soso-panel .soso-pad2 .soso-grid{stroke:var(--panel-fg);stroke-opacity:.25}.soso-panel .soso-pad2 .soso-label{fill:var(--panel-fg);opacity:.5}.soso-panel .soso-pad2 .soso-indicator{fill:var(--panel-fg)}.soso-panel button.soso-translate{font-weight:bolder}.soso-panel button.soso-translate.soso-selected{cursor:grabbing}.soso-panel input[type=text]{color:var(--value-string);font-family:var(--font-value)}.soso-panel input[type=text].soso-number-input{color:var(--value-number)}.soso-panel input[type=number]::-webkit-inner-spin-button,.soso-panel input[type=number]::-webkit-outer-spin-button{appearance:none;margin:0}.soso-panel input[type=text].soso-fixed{width:60px}.soso-panel .soso-control>.soso-display{line-height:var(--row-height)}.soso-panel .soso-control>.soso-display.soso-monospace{font-family:var(--font-value)}.soso-panel .soso-display a{color:var(--color-link);text-decoration:underline}.soso-panel .soso-display a:hover{text-decoration:none}.soso-panel pre.soso-display{margin:0}.soso-panel input[type=checkbox]{margin:0;appearance:none;border-radius:var(--panel-radius);width:14px;height:14px;text-align:center}.soso-panel input[type=checkbox]:checked:before{content:"";display:flex;height:var(--checkbox-check-height);width:var(--checkbox-check-width);border-bottom:2px solid var(--panel-fg);border-right:2px solid var(--panel-fg);transform:rotate(45deg)}.soso-panel input[type=range]{-webkit-appearance:none;appearance:none;background:transparent;margin:0;padding:0}.soso-panel input[type=range]::-webkit-slider-runnable-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.soso-panel input[type=range]::-moz-range-track{background:var(--panel-border);height:3px;border-radius:2px;margin:0 -1px}.soso-panel input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);margin-top:-4px}.soso-panel input[type=range]::-moz-range-thumb{width:12px;height:12px;border-radius:var(--panel-radius);background:var(--panel-fg);border:none}.soso-panel input[type=color]{-webkit-appearance:none;border:1px solid var(--panel-border);padding:0;border-radius:var(--panel-radius);height:var(--row-height)}.soso-panel input[type=color]::-webkit-color-swatch-wrapper{padding:0}.soso-panel input[type=color]::-webkit-color-swatch{border:0}.soso-panel canvas.soso-graph{width:100%}',Wt=0,qt=e=>`node ${Wt++}`,et=e=>{let{id:t=qt(),nodes:o=[],...n}=e,s={},a={id:t,nodes:[]},l={id:t},i=dt(e);for(let p in i)typeof i[p]=="function"?l[p]=i[p]({...i,...e}):l[p]=i[p];return Object.assign(l,n),s[t]=l,o.length>0&&o.forEach(p=>{let[u,c]=et(p);Object.assign(s,u),a.nodes.push(c)}),[s,a]},Vt=()=>{let e=document.createElement("div");return e.classList.add("soso-panel-container"),document.body.append(e),e},Ot=()=>{if(!document.querySelector("style[data-soso-panel]")){let e=document.createElement("style");e.textContent=$t,e.setAttribute("data-soso-panel","true"),document.head.appendChild(e)}},Ie=Symbol("all"),Gt=class{constructor(e,t){let[o,n]=et(e);this.nodes=o,this.root=n,this.container=t.mount??Vt(),this.options=t,this.subscribers=new Map,this.raf=null,t.injectStyles&&Ot(),this.render()}render(){let e=()=>{Se(h("div",{className:`soso-panel ${this.options.classNames.join(" ")}`,children:h(Ze,{nodes:this.nodes,treeNode:this.root,update:this.handleUpdate.bind(this)})}),this.container)};if(!this.options.throttleRendering){e();return}this.options.throttleRendering&&!this.raf&&(this.raf=requestAnimationFrame(()=>{e(),this.raf=null}))}handleUpdate(e,{silent:t=!1,event:o=!1}={}){if(typeof e!="object"){console.warn("could not set values: invalid values object");return}for(let n in e){let s=this.nodes[n];if(!s)continue;let a=e[n];o||(this.nodes[n]={...s,...a}),"value"in a&&!t&&this.notifySubscribers(n,e[n].value)}this.render()}notifySubscribers(e,t){this.subscribers.get(e)?.forEach(o=>o(t)),this.subscribers.get(Ie)?.forEach(o=>o(e,t))}subscribe(e,t){let o=typeof e=="string"?e:Ie,n=typeof t=="function"?t:typeof e=="function"?e:void 0;if(n===void 0){console.warn("could not subscribe: no handler");return}return this.subscribers.has(o)||this.subscribers.set(o,[]),this.subscribers.get(o).push(n),()=>{let s=this.subscribers.get(o),a=s.indexOf(n);a>-1?s.splice(a,1):console.warn("could not unsubscribe: could not find handler")}}set(e,t){let o={};for(let n in e)o[n]={value:e[n]};this.handleUpdate(o,t)}update(e,t){this.handleUpdate(e,{...t,event:!1})}get(){let e={};for(let t in this.nodes){let o=this.nodes[t]?.value;o!==void 0&&(e[t]=o)}return e}destroy(){this.raf&&cancelAnimationFrame(this.raf),Se(null,this.container),this.options.mount||this.container.remove(),this.subscribers.clear(),this.values={}}},tt={create(e,t={}){let o=Array.isArray(e)?{type:"group",label:"controls",nodes:e}:e,n=new Gt(o,{throttleRendering:!0,injectStyles:!0,classNames:[],...t});return{subscribe:n.subscribe.bind(n),update:n.update.bind(n),set:n.set.bind(n),get:n.get.bind(n),destroy:n.destroy.bind(n)}}};var ot=200,se=300,Jt={slow:{color:"rgba(0, 0, 0, 1)",speed:1,size:8},fast:{color:"rgba(255, 0, 110, 1)",speed:3,size:5},heavy:{color:"rgba(0, 102, 255, 1)",speed:.5,size:12}},k={gravity:.1,bounce:.8,friction:.99,spawnRate:2,burstSize:50},D=tt.create({id:"particles",type:"group",nodes:[{id:"total",type:"graph",label:"total",min:0,max:ot},{id:"velocity",type:"graph",label:"avg velocity",min:0,max:10},{id:"collisions",type:"graph",label:"collisions/s"},{type:"group",label:"physics",expanded:!0,nodes:[{id:"gravity",type:"range",label:"gravity",min:-.5,max:.5,step:.01,value:k.gravity},{id:"bounce",type:"range",label:"bounce",min:0,max:1,step:.01,value:k.bounce},{id:"friction",type:"range",label:"friction",min:.9,max:1,step:.001,value:k.friction}]},{type:"group",label:"spawn",expanded:!0,nodes:[{id:"spawnRate",type:"range",label:"flow rate",min:1,max:5,step:1,value:k.spawnRate},{id:"spawnType",type:"toggle-group",label:"type",value:"slow",options:["slow","fast","heavy"]},{type:"button",id:"burst",text:"\u{1F4A5}"},{type:"button",id:"reset",text:"reset"}]}]}),ge=class{constructor(t,o,n){let s=Jt[n];this.x=t,this.y=o,this.vx=(Math.random()-.5)*s.speed*4,this.vy=(Math.random()-.5)*s.speed*4,this.type=n,this.size=s.size,this.color=s.color,this.collided=!1,this.age=0}update(t){return this.age++,this.age>se||(this.vy+=k.gravity,this.vx*=k.friction,this.vy*=k.friction,this.x+=this.vx,this.y+=this.vy,(this.x-this.size<0||this.x+this.size>t.width)&&(this.x=Math.max(this.size,Math.min(t.width-this.size,this.x)),this.vx*=-k.bounce),(this.y-this.size<0||this.y+this.size>t.height)&&(this.y=Math.max(this.size,Math.min(t.height-this.size,this.y)),this.vy*=-k.bounce,this.y+this.size>=t.height&&(this.vx*=.9)),Math.sqrt(this.vx*this.vx+this.vy*this.vy)<.1&&this.y+this.size>=t.height-1)?!1:(this.collided=!1,!0)}checkCollision(t){let o=t.x-this.x,n=t.y-this.y,s=Math.sqrt(o*o+n*n),a=this.size+t.size;if(s<a&&s>0){let l=Math.atan2(n,o),i=this.x+Math.cos(l)*a,p=this.y+Math.sin(l)*a,u=(i-t.x)*.1,c=(p-t.y)*.1;return this.vx-=u,this.vy-=c,t.vx+=u,t.vy+=c,this.collided=!0,t.collided=!0,!0}return!1}draw(t){let o=this.age>se*.8?(se-this.age)/(se*.2):1;t.fillStyle=this.color.replace("1)",`${o})`),t.beginPath(),t.arc(this.x,this.y,this.size,0,2*Math.PI),t.fill(),this.collided&&(t.strokeStyle=`rgba(255, 255, 255, ${.8*o})`,t.lineWidth=2,t.stroke())}getSpeed(){return Math.sqrt(this.vx*this.vx+this.vy*this.vy)}},T=[];var q=[],re=!1,be=0,ye=0,N=document.createElement("canvas"),me=N.getContext("2d"),Kt=document.getElementById("canvas-container"),nt=document.getElementById("prompt");Kt.appendChild(N);var st=()=>nt&&nt.remove(),at=()=>{N.width=window.innerWidth,N.height=window.innerHeight},rt=e=>{let t=N.getBoundingClientRect();return e.touches&&e.touches.length>0?{x:e.touches[0].clientX-t.left,y:e.touches[0].clientY-t.top}:{x:e.clientX-t.left,y:e.clientY-t.top}},ae=(e,t,o,n)=>{for(;T.length+o>ot;)T.shift();for(let s=0;s<o;s++){let a=Math.random()*Math.PI*2,l=Math.random()*15,i=e+Math.cos(a)*l,p=t+Math.sin(a)*l;T.push(new ge(i,p,n))}},lt=()=>{if(me.fillStyle="white",me.fillRect(0,0,N.width,N.height),re){let n=D.get().spawnType;ae(be,ye,k.spawnRate,n)}T=T.filter(n=>n.update(N));let e=0;for(let n=0;n<T.length;n++)for(let s=n+1;s<T.length;s++)T[n].checkCollision(T[s])&&e++;q.push(e),q.length>60&&q.shift();let t=q.reduce((n,s)=>n+s,0);T.forEach(n=>n.draw(me));let o=T.length>0?T.reduce((n,s)=>n+s.getSpeed(),0)/T.length:0;D.set({total:T.length,velocity:o,collisions:t},{silent:!0}),requestAnimationFrame(lt)};D.subscribe((e,t)=>{e in k&&(k[e]=t)});var Qt="slow";D.subscribe("spawnType",e=>{Qt=e});D.subscribe("burst",()=>{st();let e=N.width/2,t=N.height/2,o=Math.floor(k.burstSize/3);ae(e,t,o,"slow"),ae(e,t,o,"fast"),ae(e,t,o,"heavy")});D.subscribe("reset",()=>{T=[],q=[],k.gravity=.1,k.bounce=.8,k.friction=.99,k.spawnRate=2,k.burstSize=50,D.set({gravity:.1,bounce:.8,friction:.99,spawnRate:2,spawnType:"slow"})});var it=e=>{st(),re=!0;let t=rt(e);be=t.x,ye=t.y},ut=e=>{if(!re)return;e.preventDefault();let t=rt(e);be=t.x,ye=t.y},le=()=>{re=!1};N.addEventListener("mousedown",it);N.addEventListener("mousemove",ut);N.addEventListener("mouseup",le);N.addEventListener("mouseout",le);N.addEventListener("touchstart",it,{passive:!1});N.addEventListener("touchmove",ut,{passive:!1});N.addEventListener("touchend",le);N.addEventListener("touchcancel",le);window.addEventListener("resize",at);at();lt();
